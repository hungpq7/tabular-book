
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Pandas: Data Transformation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Janitor: Pandas Extensions" href="janitor-pandas-extensions.html" />
    <link rel="prev" title="Pandas: Data Cleaning" href="pandas-data-cleaning.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.svg" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../util/intro.html">
                    Data Science
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-01/_intro.html">
   <b>
    1. Python Programming
   </b>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-01/python-basic-concepts.html">
     Python: Basic Concepts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-01/python-data-types.html">
     Python: Data Types
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-01/python-data-containers.html">
     Python: Data Containers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-01/python-functions-objects.html">
     Python: Functions and Objects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-01/python-algorithms.html">
     (w) Python: Algorithms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-01/python-external-sources.html">
     Python: External Sources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-01/selenium-web-scraping.html">
     Selenium: Web Scraping
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-02/_intro.html">
   <b>
    2. Mathematics
   </b>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-02/numpy-linear-algebra.html">
     NumPy: Linear Algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-02/sympy-calculus.html">
     SymPy: Calculus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-02/numpy-probability.html">
     NumPy: Probability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-02/numpy-statistics.html">
     NumPy: Statistics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-02/scipy-hypothesis-testing.html">
     SciPy: Hypothesis Testing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-02/numpy-applied-mathematics.html">
     (w) NumPy: Applied Mathematics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-02/networkx-network-analysis.html">
     (w) NetworkX: Network Analysis
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="_intro.html">
   <b>
    3. Data Manipulation
   </b>
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="numpy-arrays.html">
     NumPy: Arrays
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pandas-data-exploratory.html">
     Pandas: Data Exploratory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pandas-data-cleaning.html">
     Pandas: Data Cleaning
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Pandas: Data Transformation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="janitor-pandas-extensions.html">
     Janitor: Pandas Extensions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-04/_intro.html">
   <b>
    4. Big Data
   </b>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-04/hiveql-data-manipulation.html">
     HiveQL: Data Manipulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-04/pyspark-data-exploratory.html">
     PySpark: Data Exploratory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-04/pyspark-data-cleaning.html">
     PySpark: Data Cleaning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-04/pyspark-data-transformation.html">
     PySpark: Data Transformation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-04/dask-parallelized-pandas.html">
     Dask: Parallelized Pandas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-05/_intro.html">
   <b>
    5. Data Visualization
   </b>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-05/matplotlib-graph-construction.html">
     Matplotlib: Graph Construction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-05/seaborn-statistical-visualization.html">
     Seaborn: Statistical Visualization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-05/plotly-interactive-visualization.html">
     Plotly: Interactive Visualization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-06/_intro.html">
   <b>
    6. Machine Learning
   </b>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-06/sklearn-machine-learning.html">
     Sklearn: Machine Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-06/sklearn-classification.html">
     Sklearn: Classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-06/sklearn-regression.html">
     Sklearn: Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-06/sklearn-feature-engineering.html">
     Sklearn: Feature Engineering
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-06/lenskit-recommendation.html">
     Lenskit: Recommendation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-06/pyspark-machine-learning.html">
     PySpark: Machine Learning
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-07/_intro.html">
   <b>
    7. Tabular Learning
   </b>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-07/sklearn-ensemble-learning.html">
     Sklearn: Ensemble Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-07/xgboost-tree-boosting.html">
     XGBoost: Tree Boosting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-07/ray-hyperparameter-optimization.html">
     Ray: Hyperparam Optimization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-07/shap-model-interpretation.html">
     (w) Shap: Model Interpretation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-07/imblearn-targeted-modeling.html">
     (w) Imblearn: Targeted Modeling
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-08/_intro.html">
   <b>
    8. Time Series
   </b>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-08/statsmodels-temporal-analysis.html">
     Statsmodels: Temporal Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-08/prophet-forecasting-algorithms.html">
     Prophet: Forecasting Algorithms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-08/sktime-forecasting-pipeline.html">
     Sktime: Forecasting Pipeline
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-08/darts-deep-forecasting.html">
     (w) Darts: Deep Forecasting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-09/_intro.html">
   <b>
    9. Unsupervised Learning
   </b>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-09/mlxtend-association-rules.html">
     (w) Mlxtend: Association Rules
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-09/sklearn-clustering.html">
     Sklearn: Clustering
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-09/sklearn-dimensional-reduction.html">
     Sklearn: Dimensional Reduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-09/pyod-anomaly-detection.html">
     PyOD: Anomaly Detection
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-10/_intro.html">
   <b>
    10. Deep Learning
   </b>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/gensim-text-mining.html">
     Gensim: Text Mining
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/opencv-image-processing.html">
     (w) OpenCV: Image Processing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/numpy-gradient-descent.html">
     Python: Gradient Descent
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/keras-multilayer-perceptron.html">
     Keras: Multilayer Perceptron
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/keras-recurrent-networks.html">
     Keras: Recurrent Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/keras-convolutional-networks.html">
     (w) Keras: Convolutional Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/pytorch-deep-learning.html">
     PyTorch: Deep Learning
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-11/_intro.html">
   <b>
    11. R Programming
   </b>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/r-basic-concepts.html">
     R: Basic Concepts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/r-data-structures.html">
     R: Data Structures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/tidyverse-data-wrangling.html">
     Tidyverse: Data Wrangling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/dplyr-data-cleaning.html">
     Dplyr: Data Cleaning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/ggplot-data-visualization.html">
     Ggplot: Data Visualization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-11/r-statistics.html">
     R: Statistics
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/hungpq7/tabular-book/master?urlpath=tree/chapter-03/pandas-data-transformation.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/hungpq7/tabular-book/blob/master/chapter-03/pandas-data-transformation.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/hungpq7/tabular-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/chapter-03/pandas-data-transformation.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#miscellaneous-techniques">
   1. Miscellaneous techniques
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mapping">
     1.1. Mapping
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mapping-with-a-dictionary">
       Mapping with a dictionary
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mapping-with-a-function">
       Mapping with a function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#window-functions">
     1.2. Window functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pivot-table">
   2. Pivot table
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wide-and-long-form">
     2.1. Wide and long form
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#wide-form-table">
       Wide form table
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#long-form-table">
       Long form table
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unpivoting">
     2.2. Unpivoting
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     2.3. Pivot table
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#basic-pivoting">
       Basic pivoting
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#multivariate-pivoting">
       Multivariate pivoting
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#pivoting-vs-grouping">
       Pivoting vs. grouping
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#combining-datasets">
   3. Combining datasets
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#appending">
     3.1. Appending
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#single-appending">
       Single appending
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#multiple-concatenation">
       Multiple concatenation
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#merging">
     3.2. Merging
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Pandas: Data Transformation</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#miscellaneous-techniques">
   1. Miscellaneous techniques
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mapping">
     1.1. Mapping
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mapping-with-a-dictionary">
       Mapping with a dictionary
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mapping-with-a-function">
       Mapping with a function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#window-functions">
     1.2. Window functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pivot-table">
   2. Pivot table
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wide-and-long-form">
     2.1. Wide and long form
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#wide-form-table">
       Wide form table
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#long-form-table">
       Long form table
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unpivoting">
     2.2. Unpivoting
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     2.3. Pivot table
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#basic-pivoting">
       Basic pivoting
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#multivariate-pivoting">
       Multivariate pivoting
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#pivoting-vs-grouping">
       Pivoting vs. grouping
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#combining-datasets">
   3. Combining datasets
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#appending">
     3.1. Appending
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#single-appending">
       Single appending
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#multiple-concatenation">
       Multiple concatenation
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#merging">
     3.2. Merging
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="pandas-data-transformation">
<h1>Pandas: Data Transformation<a class="headerlink" href="#pandas-data-transformation" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<section id="miscellaneous-techniques">
<h2>1. Miscellaneous techniques<a class="headerlink" href="#miscellaneous-techniques" title="Permalink to this headline">#</a></h2>
<section id="mapping">
<h3>1.1. Mapping<a class="headerlink" href="#mapping" title="Permalink to this headline">#</a></h3>
<p>Map is the generalization of function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfStudent</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;student_id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;010001&#39;</span><span class="p">,</span> <span class="s1">&#39;030001&#39;</span><span class="p">,</span> <span class="s1">&#39;070001&#39;</span><span class="p">,</span> <span class="s1">&#39;080001&#39;</span><span class="p">,</span> <span class="s1">&#39;110001&#39;</span><span class="p">,</span> <span class="s1">&#39;120001&#39;</span><span class="p">],</span>
    <span class="s1">&#39;gender&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Male&#39;</span><span class="p">,</span> <span class="s1">&#39;Female&#39;</span><span class="p">,</span> <span class="s1">&#39;Female&#39;</span><span class="p">,</span> <span class="s1">&#39;Female&#39;</span><span class="p">,</span> <span class="s1">&#39;Male&#39;</span><span class="p">,</span> <span class="s1">&#39;Female&#39;</span><span class="p">]</span>
<span class="p">})</span>
<span class="n">dfStudent</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>student_id</th>
      <th>gender</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>010001</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>1</th>
      <td>030001</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>2</th>
      <td>070001</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>3</th>
      <td>080001</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>4</th>
      <td>110001</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>5</th>
      <td>120001</td>
      <td>Female</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="mapping-with-a-dictionary">
<h4>Mapping with a dictionary<a class="headerlink" href="#mapping-with-a-dictionary" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gender_map</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Female&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Male&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">dfStudent</span><span class="o">.</span><span class="n">gender</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">gender_map</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    1
1    0
2    0
3    0
4    1
5    0
Name: gender, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="mapping-with-a-function">
<h4>Mapping with a function<a class="headerlink" href="#mapping-with-a-function" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfStudent</span><span class="p">[</span><span class="s1">&#39;grade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfStudent</span><span class="o">.</span><span class="n">student_id</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">[:</span><span class="mi">2</span><span class="p">]))</span>
<span class="n">dfStudent</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>student_id</th>
      <th>gender</th>
      <th>grade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>010001</td>
      <td>Male</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>030001</td>
      <td>Female</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>070001</td>
      <td>Female</td>
      <td>7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>080001</td>
      <td>Female</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>110001</td>
      <td>Male</td>
      <td>11</td>
    </tr>
    <tr>
      <th>5</th>
      <td>120001</td>
      <td>Female</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">stage_map</span><span class="p">(</span><span class="n">grade</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">grade</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
        <span class="n">stage</span> <span class="o">=</span> <span class="s1">&#39;Primary&#39;</span>
    <span class="k">if</span> <span class="n">grade</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="n">stage</span> <span class="o">=</span> <span class="s1">&#39;Secondary&#39;</span>
    <span class="k">if</span> <span class="n">grade</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">):</span>
        <span class="n">stage</span> <span class="o">=</span> <span class="s1">&#39;High&#39;</span>
    <span class="k">return</span> <span class="n">stage</span>

<span class="n">dfStudent</span><span class="p">[</span><span class="s1">&#39;stage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfStudent</span><span class="o">.</span><span class="n">grade</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">stage_map</span><span class="p">)</span>
<span class="n">dfStudent</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>student_id</th>
      <th>gender</th>
      <th>grade</th>
      <th>stage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>010001</td>
      <td>Male</td>
      <td>1</td>
      <td>Primary</td>
    </tr>
    <tr>
      <th>1</th>
      <td>030001</td>
      <td>Female</td>
      <td>3</td>
      <td>Primary</td>
    </tr>
    <tr>
      <th>2</th>
      <td>070001</td>
      <td>Female</td>
      <td>7</td>
      <td>Secondary</td>
    </tr>
    <tr>
      <th>3</th>
      <td>080001</td>
      <td>Female</td>
      <td>8</td>
      <td>Secondary</td>
    </tr>
    <tr>
      <th>4</th>
      <td>110001</td>
      <td>Male</td>
      <td>11</td>
      <td>High</td>
    </tr>
    <tr>
      <th>5</th>
      <td>120001</td>
      <td>Female</td>
      <td>12</td>
      <td>High</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="window-functions">
<h3>1.2. Window functions<a class="headerlink" href="#window-functions" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;manufacturer&#39;</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="p">]</span>
<span class="n">dfCar</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/cars.csv&#39;</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">dfCar</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>manufacturer</th>
      <th>model</th>
      <th>type</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Chevrolet</td>
      <td>Cavalier</td>
      <td>Compact</td>
      <td>13.4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Chevrolet</td>
      <td>Corsica</td>
      <td>Compact</td>
      <td>11.4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Chevrolet</td>
      <td>Camaro</td>
      <td>Sporty</td>
      <td>15.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Chevrolet</td>
      <td>Lumina</td>
      <td>Midsize</td>
      <td>15.9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Chevrolet</td>
      <td>Lumina_APV</td>
      <td>Van</td>
      <td>16.3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfCar</span><span class="p">[[</span><span class="s1">&#39;manufacturer&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">]]</span>\
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">rank</span><span class="o">=</span><span class="n">dfCar</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;manufacturer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">price</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>\
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dense_rank</span><span class="o">=</span><span class="n">dfCar</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;manufacturer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">price</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;dense&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>\
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">row_number</span><span class="o">=</span><span class="n">dfCar</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;manufacturer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">price</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>\
    <span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;manufacturer&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">])</span>\
    <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCar</span><span class="o">.</span><span class="n">manufacturer</span><span class="o">==</span><span class="s1">&#39;Hyundai&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>manufacturer</th>
      <th>price</th>
      <th>rank</th>
      <th>dense_rank</th>
      <th>row_number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>21</th>
      <td>Hyundai</td>
      <td>8.0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Hyundai</td>
      <td>10.0</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Hyundai</td>
      <td>10.0</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Hyundai</td>
      <td>13.9</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Hyundai</td>
      <td>16.1</td>
      <td>5</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Hyundai</td>
      <td>18.8</td>
      <td>6</td>
      <td>5</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="pivot-table">
<h2>2. Pivot table<a class="headerlink" href="#pivot-table" title="Permalink to this headline">#</a></h2>
<section id="wide-and-long-form">
<h3>2.1. Wide and long form<a class="headerlink" href="#wide-and-long-form" title="Permalink to this headline">#</a></h3>
<section id="wide-form-table">
<h4>Wide form table<a class="headerlink" href="#wide-form-table" title="Permalink to this headline">#</a></h4>
<p>Wide form table divides a variable and places each part in a column. Therefore, it allows displaying more data, and is convenient for keeping tract of exactly one index (sales or profit, for example). However, wide form supports not very well storing two variables ore more.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Color</p></th>
<th class="text-align:right head"><p>2000 Q1</p></th>
<th class="text-align:right head"><p>2000 Q2</p></th>
<th class="text-align:right head"><p>2000 Q3</p></th>
<th class="text-align:right head"><p>2000 Q4</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>Red</p></td>
<td class="text-align:right"><p>$ 1000</p></td>
<td class="text-align:right"><p>$ 1200</p></td>
<td class="text-align:right"><p>$ 1500</p></td>
<td class="text-align:right"><p>$ 1700</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Green</p></td>
<td class="text-align:right"><p>$ 1500</p></td>
<td class="text-align:right"><p>$ 1500</p></td>
<td class="text-align:right"><p>$ 1575</p></td>
<td class="text-align:right"><p>$ 1800</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Blue</p></td>
<td class="text-align:right"><p>$ 2000</p></td>
<td class="text-align:right"><p>$ 2200</p></td>
<td class="text-align:right"><p>$ 2000</p></td>
<td class="text-align:right"><p>$ 2800</p></td>
</tr>
</tbody>
</table>
</section>
<section id="long-form-table">
<h4>Long form table<a class="headerlink" href="#long-form-table" title="Permalink to this headline">#</a></h4>
<p>Long form stores each variable in only one column, enables unlimited number of features. In data analysis, long form is considered tidy data and is used as standard tabular data format.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Color</p></th>
<th class="text-align:left head"><p>Quarter</p></th>
<th class="text-align:right head"><p>Sales</p></th>
<th class="text-align:right head"><p>Quantity</p></th>
<th class="text-align:right head"><p>Price</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>Red</p></td>
<td class="text-align:left"><p>2000 Q1</p></td>
<td class="text-align:right"><p>$ 1000</p></td>
<td class="text-align:right"><p>50</p></td>
<td class="text-align:right"><p>$ 20</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Green</p></td>
<td class="text-align:left"><p>2000 Q1</p></td>
<td class="text-align:right"><p>$ 1500</p></td>
<td class="text-align:right"><p>50</p></td>
<td class="text-align:right"><p>$ 30</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Blue</p></td>
<td class="text-align:left"><p>2000 Q1</p></td>
<td class="text-align:right"><p>$ 2000</p></td>
<td class="text-align:right"><p>40</p></td>
<td class="text-align:right"><p>$ 50</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Red</p></td>
<td class="text-align:left"><p>2000 Q2</p></td>
<td class="text-align:right"><p>$ 1200</p></td>
<td class="text-align:right"><p>60</p></td>
<td class="text-align:right"><p>$ 20</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Green</p></td>
<td class="text-align:left"><p>2000 Q2</p></td>
<td class="text-align:right"><p>$ 1500</p></td>
<td class="text-align:right"><p>50</p></td>
<td class="text-align:right"><p>$ 30</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Blue</p></td>
<td class="text-align:left"><p>2000 Q2</p></td>
<td class="text-align:right"><p>$ 2200</p></td>
<td class="text-align:right"><p>40</p></td>
<td class="text-align:right"><p>$ 55</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Red</p></td>
<td class="text-align:left"><p>2000 Q3</p></td>
<td class="text-align:right"><p>$ 1500</p></td>
<td class="text-align:right"><p>75</p></td>
<td class="text-align:right"><p>$ 20</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Green</p></td>
<td class="text-align:left"><p>2000 Q3</p></td>
<td class="text-align:right"><p>$ 1575</p></td>
<td class="text-align:right"><p>45</p></td>
<td class="text-align:right"><p>$ 35</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Blue</p></td>
<td class="text-align:left"><p>2000 Q3</p></td>
<td class="text-align:right"><p>$ 2000</p></td>
<td class="text-align:right"><p>40</p></td>
<td class="text-align:right"><p>$ 50</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Red</p></td>
<td class="text-align:left"><p>2000 Q4</p></td>
<td class="text-align:right"><p>$ 1700</p></td>
<td class="text-align:right"><p>85</p></td>
<td class="text-align:right"><p>$ 20</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Green</p></td>
<td class="text-align:left"><p>2000 Q4</p></td>
<td class="text-align:right"><p>$ 1800</p></td>
<td class="text-align:right"><p>20</p></td>
<td class="text-align:right"><p>$ 60</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Blue</p></td>
<td class="text-align:left"><p>2000 Q4</p></td>
<td class="text-align:right"><p>$ 2800</p></td>
<td class="text-align:right"><p>70</p></td>
<td class="text-align:right"><p>$ 40</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="unpivoting">
<h3>2.2. Unpivoting<a class="headerlink" href="#unpivoting" title="Permalink to this headline">#</a></h3>
<p>Unpivoting is the process of transforming a table from wide form to long form. This technique is very useful in tidying up messy data.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfSales</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">],</span>
    <span class="s1">&#39;2000 Q1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="mi">2000</span><span class="p">],</span>
    <span class="s1">&#39;2000 Q2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1200</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="mi">2200</span><span class="p">],</span>
    <span class="s1">&#39;2000 Q3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1500</span><span class="p">,</span> <span class="mi">1575</span><span class="p">,</span> <span class="mi">2000</span><span class="p">],</span>
    <span class="s1">&#39;2000 Q4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1700</span><span class="p">,</span> <span class="mi">1800</span><span class="p">,</span> <span class="mi">2800</span><span class="p">],</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfSales</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>2000 Q1</th>
      <th>2000 Q2</th>
      <th>2000 Q3</th>
      <th>2000 Q4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>red</td>
      <td>1000</td>
      <td>1200</td>
      <td>1500</td>
      <td>1700</td>
    </tr>
    <tr>
      <th>1</th>
      <td>green</td>
      <td>1500</td>
      <td>1500</td>
      <td>1575</td>
      <td>1800</td>
    </tr>
    <tr>
      <th>2</th>
      <td>blue</td>
      <td>2000</td>
      <td>2200</td>
      <td>2000</td>
      <td>2800</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfSales</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;quarter&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;sales&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>quarter</th>
      <th>sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>red</td>
      <td>2000 Q1</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>green</td>
      <td>2000 Q1</td>
      <td>1500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>blue</td>
      <td>2000 Q1</td>
      <td>2000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>red</td>
      <td>2000 Q2</td>
      <td>1200</td>
    </tr>
    <tr>
      <th>4</th>
      <td>green</td>
      <td>2000 Q2</td>
      <td>1500</td>
    </tr>
    <tr>
      <th>5</th>
      <td>blue</td>
      <td>2000 Q2</td>
      <td>2200</td>
    </tr>
    <tr>
      <th>6</th>
      <td>red</td>
      <td>2000 Q3</td>
      <td>1500</td>
    </tr>
    <tr>
      <th>7</th>
      <td>green</td>
      <td>2000 Q3</td>
      <td>1575</td>
    </tr>
    <tr>
      <th>8</th>
      <td>blue</td>
      <td>2000 Q3</td>
      <td>2000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>red</td>
      <td>2000 Q4</td>
      <td>1700</td>
    </tr>
    <tr>
      <th>10</th>
      <td>green</td>
      <td>2000 Q4</td>
      <td>1800</td>
    </tr>
    <tr>
      <th>11</th>
      <td>blue</td>
      <td>2000 Q4</td>
      <td>2800</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="id1">
<h3>2.3. Pivot table<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<p>Pivoting is the process of transforming a table from long form to wide form. Notice that the table in this case is already tidy, so pivot table mainly works as a tool to summarise data.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfLong</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Market&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Asian&#39;</span><span class="p">,</span> <span class="s1">&#39;Asian&#39;</span><span class="p">,</span> <span class="s1">&#39;Asian&#39;</span><span class="p">,</span> <span class="s1">&#39;Asian&#39;</span><span class="p">,</span> <span class="s1">&#39;Europe&#39;</span><span class="p">,</span> <span class="s1">&#39;Europe&#39;</span><span class="p">,</span> <span class="s1">&#39;Europe&#39;</span><span class="p">,</span> <span class="s1">&#39;Europe&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Color&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Red&#39;</span><span class="p">,</span> <span class="s1">&#39;Red&#39;</span><span class="p">,</span> <span class="s1">&#39;Blue&#39;</span><span class="p">,</span> <span class="s1">&#39;Blue&#39;</span><span class="p">,</span> <span class="s1">&#39;Red&#39;</span><span class="p">,</span> <span class="s1">&#39;Red&#39;</span><span class="p">,</span> <span class="s1">&#39;Blue&#39;</span><span class="p">,</span> <span class="s1">&#39;Blue&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Size&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Large&#39;</span><span class="p">,</span> <span class="s1">&#39;Small&#39;</span><span class="p">,</span> <span class="s1">&#39;Large&#39;</span><span class="p">,</span> <span class="s1">&#39;Small&#39;</span><span class="p">,</span><span class="s1">&#39;Large&#39;</span><span class="p">,</span> <span class="s1">&#39;Small&#39;</span><span class="p">,</span> <span class="s1">&#39;Large&#39;</span><span class="p">,</span> <span class="s1">&#39;Small&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Price&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
    <span class="s1">&#39;Sales&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">68000</span><span class="p">,</span> <span class="mi">44000</span><span class="p">,</span> <span class="mi">57000</span><span class="p">,</span> <span class="mi">52000</span><span class="p">,</span> <span class="mi">81000</span><span class="p">,</span> <span class="mi">72000</span><span class="p">,</span> <span class="mi">90000</span><span class="p">,</span> <span class="mi">77000</span><span class="p">]</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfLong</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Market</th>
      <th>Color</th>
      <th>Size</th>
      <th>Price</th>
      <th>Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Asian</td>
      <td>Red</td>
      <td>Large</td>
      <td>17</td>
      <td>68000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Asian</td>
      <td>Red</td>
      <td>Small</td>
      <td>11</td>
      <td>44000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Asian</td>
      <td>Blue</td>
      <td>Large</td>
      <td>19</td>
      <td>57000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Asian</td>
      <td>Blue</td>
      <td>Small</td>
      <td>13</td>
      <td>52000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Europe</td>
      <td>Red</td>
      <td>Large</td>
      <td>18</td>
      <td>81000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Europe</td>
      <td>Red</td>
      <td>Small</td>
      <td>12</td>
      <td>72000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Europe</td>
      <td>Blue</td>
      <td>Large</td>
      <td>20</td>
      <td>90000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Europe</td>
      <td>Blue</td>
      <td>Small</td>
      <td>14</td>
      <td>77000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="basic-pivoting">
<h4>Basic pivoting<a class="headerlink" href="#basic-pivoting" title="Permalink to this headline">#</a></h4>
<p>Pivoting usually returns duplicated values, handling them requires an aggregate function. The default function used in the <code class="docutils literal notranslate"><span class="pre">pivot_table()</span></code> method is <code class="docutils literal notranslate"><span class="pre">np.mean()</span></code>. In this example, using <code class="docutils literal notranslate"><span class="pre">np.sum()</span></code> for <code class="docutils literal notranslate"><span class="pre">Sales</span></code> and <code class="docutils literal notranslate"><span class="pre">np.mean</span></code> for <code class="docutils literal notranslate"><span class="pre">Price</span></code> makes sense.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfLong</span>\
    <span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
        <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Market&#39;</span><span class="p">,</span> <span class="s1">&#39;Color&#39;</span><span class="p">],</span>
        <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Size&#39;</span><span class="p">,</span>
        <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Sales&#39;</span><span class="p">,</span>
        <span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
    <span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Market</th>
      <th>Color</th>
      <th>Large</th>
      <th>Small</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Asian</td>
      <td>Blue</td>
      <td>57000</td>
      <td>52000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Asian</td>
      <td>Red</td>
      <td>68000</td>
      <td>44000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Europe</td>
      <td>Blue</td>
      <td>90000</td>
      <td>77000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Europe</td>
      <td>Red</td>
      <td>81000</td>
      <td>72000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfLong</span>\
    <span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
        <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Market&#39;</span><span class="p">,</span> <span class="s1">&#39;Color&#39;</span><span class="p">],</span>
        <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Size&#39;</span><span class="p">,</span>
        <span class="n">values</span><span class="o">=</span><span class="s1">&#39;Price&#39;</span><span class="p">,</span>
        <span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>\
    <span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Market</th>
      <th>Color</th>
      <th>Large</th>
      <th>Small</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Asian</td>
      <td>Blue</td>
      <td>19</td>
      <td>13</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Asian</td>
      <td>Red</td>
      <td>17</td>
      <td>11</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Europe</td>
      <td>Blue</td>
      <td>20</td>
      <td>14</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Europe</td>
      <td>Red</td>
      <td>18</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="multivariate-pivoting">
<h4>Multivariate pivoting<a class="headerlink" href="#multivariate-pivoting" title="Permalink to this headline">#</a></h4>
<p>The more advanced the technique, the more complicated the tools are.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfWide</span> <span class="o">=</span> <span class="n">dfLong</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="s1">&#39;Market&#39;</span><span class="p">,</span>
    <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Color&#39;</span><span class="p">,</span>
    <span class="n">aggfunc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Price&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="s1">&#39;Sales&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">dfWide</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">Price</th>
      <th colspan="2" halign="left">Sales</th>
    </tr>
    <tr>
      <th>Color</th>
      <th>Blue</th>
      <th>Red</th>
      <th>Blue</th>
      <th>Red</th>
    </tr>
    <tr>
      <th>Market</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Asian</th>
      <td>16</td>
      <td>14</td>
      <td>109000</td>
      <td>112000</td>
    </tr>
    <tr>
      <th>Europe</th>
      <td>17</td>
      <td>15</td>
      <td>167000</td>
      <td>153000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By passing a dictionary to the <code class="docutils literal notranslate"><span class="pre">aggfunc</span></code> parameter, the columns to be used as values are specified. Therefore, the <code class="docutils literal notranslate"><span class="pre">values</span></code> parameter can be skipped.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfWide</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">dfWide</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
<span class="n">dfWide</span> <span class="o">=</span> <span class="n">dfWide</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">dfWide</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Market</th>
      <th>(Price, Blue)</th>
      <th>(Price, Red)</th>
      <th>(Sales, Blue)</th>
      <th>(Sales, Red)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Asian</td>
      <td>16</td>
      <td>14</td>
      <td>109000</td>
      <td>112000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Europe</td>
      <td>17</td>
      <td>15</td>
      <td>167000</td>
      <td>153000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pivoting-vs-grouping">
<h4>Pivoting vs. grouping<a class="headerlink" href="#pivoting-vs-grouping" title="Permalink to this headline">#</a></h4>
<p>Skipping the <code class="docutils literal notranslate"><span class="pre">columns</span></code> parameter ends up returning the same result as the <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfLong</span>\
    <span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
        <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Market&#39;</span><span class="p">,</span> <span class="s1">&#39;Color&#39;</span><span class="p">],</span>
        <span class="n">aggfunc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Price&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="s1">&#39;Sales&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">})</span>\
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Market</th>
      <th>Color</th>
      <th>Price</th>
      <th>Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Asian</td>
      <td>Blue</td>
      <td>16</td>
      <td>109000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Asian</td>
      <td>Red</td>
      <td>14</td>
      <td>112000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Europe</td>
      <td>Blue</td>
      <td>17</td>
      <td>167000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Europe</td>
      <td>Red</td>
      <td>15</td>
      <td>153000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfLong</span>\
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Market&#39;</span><span class="p">,</span> <span class="s1">&#39;Color&#39;</span><span class="p">])</span>\
    <span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;Price&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="s1">&#39;Sales&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">})</span>\
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Market</th>
      <th>Color</th>
      <th>Price</th>
      <th>Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Asian</td>
      <td>Blue</td>
      <td>16</td>
      <td>109000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Asian</td>
      <td>Red</td>
      <td>14</td>
      <td>112000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Europe</td>
      <td>Blue</td>
      <td>17</td>
      <td>167000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Europe</td>
      <td>Red</td>
      <td>15</td>
      <td>153000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
</section>
<section id="combining-datasets">
<h2>3. Combining datasets<a class="headerlink" href="#combining-datasets" title="Permalink to this headline">#</a></h2>
<section id="appending">
<h3>3.1. Appending<a class="headerlink" href="#appending" title="Permalink to this headline">#</a></h3>
<p>Appending is the process of concatenating data along the vertical axis (axis 0). This adds more observations to the current dataset.</p>
<section id="single-appending">
<h4>Single appending<a class="headerlink" href="#single-appending" title="Permalink to this headline">#</a></h4>
<p>The Pandas <code class="docutils literal notranslate"><span class="pre">append()</span></code> method is equivalent to the <code class="docutils literal notranslate"><span class="pre">UNION</span> <span class="pre">ALL</span></code> statement in SQL. Notice that the data to be appended bases on columns of the same name. Therefore, only neccessary columns should be kept and their names must be standardized.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfSales2000</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">],</span>
    <span class="s1">&#39;quarter&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">40000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">,</span> <span class="mi">70000</span><span class="p">,</span> <span class="mi">85000</span><span class="p">],</span>
    <span class="s1">&#39;sales&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">35000</span><span class="p">,</span> <span class="mi">38000</span><span class="p">,</span> <span class="mi">78000</span><span class="p">,</span> <span class="mi">90000</span><span class="p">]</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfSales2000</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>quarter</th>
      <th>target</th>
      <th>sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000</td>
      <td>1</td>
      <td>40000</td>
      <td>35000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000</td>
      <td>2</td>
      <td>50000</td>
      <td>38000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000</td>
      <td>3</td>
      <td>70000</td>
      <td>78000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000</td>
      <td>4</td>
      <td>85000</td>
      <td>90000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfSales2001</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">2001</span><span class="p">,</span> <span class="mi">2001</span><span class="p">,</span> <span class="mi">2001</span><span class="p">],</span>
    <span class="s1">&#39;quarter&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50000</span><span class="p">,</span> <span class="mi">60000</span><span class="p">,</span> <span class="mi">70000</span><span class="p">,</span> <span class="mi">85000</span><span class="p">],</span>
    <span class="s1">&#39;sales&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">60000</span><span class="p">,</span> <span class="mi">65000</span><span class="p">,</span> <span class="mi">82000</span><span class="p">,</span> <span class="mi">94000</span><span class="p">],</span>
    <span class="s1">&#39;profit&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20000</span><span class="p">,</span> <span class="mi">21000</span><span class="p">,</span> <span class="mi">27000</span><span class="p">,</span> <span class="mi">35000</span><span class="p">]</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfSales2001</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>quarter</th>
      <th>target</th>
      <th>sales</th>
      <th>profit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2001</td>
      <td>1</td>
      <td>50000</td>
      <td>60000</td>
      <td>20000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2001</td>
      <td>2</td>
      <td>60000</td>
      <td>65000</td>
      <td>21000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2001</td>
      <td>3</td>
      <td>70000</td>
      <td>82000</td>
      <td>27000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2001</td>
      <td>4</td>
      <td>85000</td>
      <td>94000</td>
      <td>35000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfSales2000</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dfSales2001</span><span class="p">[[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;quarter&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="s1">&#39;sales&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>quarter</th>
      <th>target</th>
      <th>sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000</td>
      <td>1</td>
      <td>40000</td>
      <td>35000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000</td>
      <td>2</td>
      <td>50000</td>
      <td>38000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000</td>
      <td>3</td>
      <td>70000</td>
      <td>78000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000</td>
      <td>4</td>
      <td>85000</td>
      <td>90000</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2001</td>
      <td>1</td>
      <td>50000</td>
      <td>60000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2001</td>
      <td>2</td>
      <td>60000</td>
      <td>65000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2001</td>
      <td>3</td>
      <td>70000</td>
      <td>82000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2001</td>
      <td>4</td>
      <td>85000</td>
      <td>94000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="multiple-concatenation">
<h4>Multiple concatenation<a class="headerlink" href="#multiple-concatenation" title="Permalink to this headline">#</a></h4>
<p>Since the current table and the table to be appended are equally treated, its possible to concatenate multiple tables at once. These tables should have the same format.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="s1">&#39;../data/world_population.xlsx&#39;</span><span class="p">)</span>
<span class="n">file</span><span class="o">.</span><span class="n">sheet_names</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;1960s&#39;, &#39;1970s&#39;, &#39;1980s&#39;, &#39;1990s&#39;, &#39;2000s&#39;, &#39;2010s&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">file</span><span class="o">.</span><span class="n">sheet_names</span><span class="p">)</span>\
    <span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s1">&#39;population&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">})</span>\
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>year</th>
      <th>country</th>
      <th>population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1960</td>
      <td>Afghanistan</td>
      <td>8996351</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1961</td>
      <td>Afghanistan</td>
      <td>9166764</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1962</td>
      <td>Afghanistan</td>
      <td>9345868</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>1963</td>
      <td>Afghanistan</td>
      <td>9533954</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>1964</td>
      <td>Afghanistan</td>
      <td>9731361</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>12258</th>
      <td>1509</td>
      <td>2012</td>
      <td>Zimbabwe</td>
      <td>14710826</td>
    </tr>
    <tr>
      <th>12259</th>
      <td>1510</td>
      <td>2013</td>
      <td>Zimbabwe</td>
      <td>15054506</td>
    </tr>
    <tr>
      <th>12260</th>
      <td>1511</td>
      <td>2014</td>
      <td>Zimbabwe</td>
      <td>15411675</td>
    </tr>
    <tr>
      <th>12261</th>
      <td>1512</td>
      <td>2015</td>
      <td>Zimbabwe</td>
      <td>15777451</td>
    </tr>
    <tr>
      <th>12262</th>
      <td>1513</td>
      <td>2016</td>
      <td>Zimbabwe</td>
      <td>16150362</td>
    </tr>
  </tbody>
</table>
<p>12263 rows  4 columns</p>
</div></div></div>
</div>
</section>
</section>
<section id="merging">
<h3>3.2. Merging<a class="headerlink" href="#merging" title="Permalink to this headline">#</a></h3>
<p>Merging is the process of concatenating data along the horizontal axis (axis 1). This adds more variables to the current dataset. The Pandas <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.merge.html"><code class="docutils literal notranslate"><span class="pre">merge()</span></code></a> method is equivalent to the <code class="docutils literal notranslate"><span class="pre">JOIN</span></code> statement in SQL.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">merge()</span></code> method uses common columns to merge on, this explains why columns should be renamed before merging. Unlike <code class="docutils literal notranslate"><span class="pre">append()</span></code>, <code class="docutils literal notranslate"><span class="pre">merge()</span></code> treats the two tables not equally, therefore there are 4 types of merge: left, right, inner and outer; indicating which keys to be used.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pandas has two advanced joining functions, <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.merge_ordered.html#pandas.merge_ordered"><code class="docutils literal notranslate"><span class="pre">merge_ordered()</span></code></a> and <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.merge_asof.html#pandas.merge_asof"><code class="docutils literal notranslate"><span class="pre">merge_asof()</span></code></a>, which can be useful in some specific scenarios.</p>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfIncome</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Hannah&#39;</span><span class="p">,</span> <span class="s1">&#39;James&#39;</span><span class="p">,</span> <span class="s1">&#39;Gabriel&#39;</span><span class="p">,</span> <span class="s1">&#39;Smith&#39;</span><span class="p">,</span> <span class="s1">&#39;Alex&#39;</span><span class="p">],</span>
    <span class="s1">&#39;income_before_tax&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">12000</span><span class="p">,</span> <span class="mi">30000</span><span class="p">,</span> <span class="mi">7000</span><span class="p">,</span> <span class="mi">20000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">],</span>
    <span class="s1">&#39;tax_band&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Allowance&#39;</span><span class="p">,</span> <span class="s1">&#39;Basic&#39;</span><span class="p">,</span> <span class="s1">&#39;Allowance&#39;</span><span class="p">,</span> <span class="s1">&#39;Basic&#39;</span><span class="p">,</span> <span class="s1">&#39;Higher&#39;</span><span class="p">]</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfIncome</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>income_before_tax</th>
      <th>tax_band</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Hannah</td>
      <td>12000</td>
      <td>Allowance</td>
    </tr>
    <tr>
      <th>1</th>
      <td>James</td>
      <td>30000</td>
      <td>Basic</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Gabriel</td>
      <td>7000</td>
      <td>Allowance</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Smith</td>
      <td>20000</td>
      <td>Basic</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Alex</td>
      <td>100000</td>
      <td>Higher</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfTax</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;band&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Allowance&#39;</span><span class="p">,</span> <span class="s1">&#39;Basic&#39;</span><span class="p">,</span> <span class="s1">&#39;Higher&#39;</span><span class="p">,</span> <span class="s1">&#39;Additional&#39;</span><span class="p">],</span>
    <span class="s1">&#39;income_range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Up to 12,500&#39;</span><span class="p">,</span> <span class="s1">&#39;12,501 to 50,000&#39;</span><span class="p">,</span> <span class="s1">&#39;50,001 to 150,000&#39;</span><span class="p">,</span> <span class="s1">&#39;Over 150,000&#39;</span><span class="p">],</span>
    <span class="s1">&#39;tax_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">]</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfTax</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>band</th>
      <th>income_range</th>
      <th>tax_rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Allowance</td>
      <td>Up to 12,500</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Basic</td>
      <td>12,501 to 50,000</td>
      <td>0.20</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Higher</td>
      <td>50,001 to 150,000</td>
      <td>0.40</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Additional</td>
      <td>Over 150,000</td>
      <td>0.45</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfIncome</span>\
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;tax_band&#39;</span><span class="p">:</span> <span class="s1">&#39;band&#39;</span><span class="p">})</span>\
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dfTax</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>income_before_tax</th>
      <th>band</th>
      <th>income_range</th>
      <th>tax_rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Hannah</td>
      <td>12000</td>
      <td>Allowance</td>
      <td>Up to 12,500</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>James</td>
      <td>30000</td>
      <td>Basic</td>
      <td>12,501 to 50,000</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Gabriel</td>
      <td>7000</td>
      <td>Allowance</td>
      <td>Up to 12,500</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Smith</td>
      <td>20000</td>
      <td>Basic</td>
      <td>12,501 to 50,000</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Alex</td>
      <td>100000</td>
      <td>Higher</td>
      <td>50,001 to 150,000</td>
      <td>0.4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "hungpq7/tabular-book",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapter-03"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="pandas-data-cleaning.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Pandas: Data Cleaning</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="janitor-pandas-extensions.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Janitor: Pandas Extensions</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Quang Hung &#9829; Thuy Linh<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>