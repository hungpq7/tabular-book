
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Numpy: Linear Algebra</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sympy: Calculus" href="sympy-calculus.html" />
    <link rel="prev" title="Numpy: Arrays" href="numpy-arrays.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../util/intro.html">
                    Data Science
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-01/_intro.html">
   <b>
    1. Python Programming
   </b>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-01/python-basic-concepts.html">
     Python: Basic Concepts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-01/python-data-types.html">
     Python: Data Types
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-01/python-data-containers.html">
     Python: Data Containers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-01/python-functions-objects.html">
     Python: Functions and Objects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-01/python-external-sources.html">
     Python: External Sources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-01/selenium-web-scraping.html">
     Selenium: Web Scraping
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="_intro.html">
   <b>
    2. Mathematics
   </b>
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="numpy-arrays.html">
     Numpy: Arrays
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Numpy: Linear Algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sympy-calculus.html">
     Sympy: Calculus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="numpy-probability.html">
     Numpy: Probability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="numpy-statistics.html">
     Numpy: Statistics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="scipy-hypothesis-testing.html">
     Scipy: Hypothesis Testing
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-04/_intro.html">
   <b>
    4. Data Visualization
   </b>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-04/matplotlib-graph-construction.html">
     Matplotlib: Graph Construction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-04/plotly-interactive-visualization.html">
     Plotly: Interactive Visualization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-06/_intro.html">
   <b>
    6. Tabular Learning
   </b>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-06/xgboost-tree-boosting.html">
     XGBoost: Tree Boosting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-09/_intro.html">
   <b>
    9. Deep Learning
   </b>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-09/numpy-gradient-descent.html">
     Python: Gradient Descent
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/hungpq7/tabular-book/master?urlpath=tree/chapter-02/numpy-linear-algebra.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/hungpq7/tabular-book/blob/master/chapter-02/numpy-linear-algebra.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/hungpq7/tabular-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/chapter-02/numpy-linear-algebra.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-concepts">
   1. Basic concepts
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#special-matrices">
     1.1. Special matrices
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#constant-matrix">
       Constant matrix
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#square-matrix">
       Square matrix
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#unit-matrix">
       Unit matrix
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#diagonal-matrix">
       Diagonal matrix
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#triangular-matrix">
       Triangular matrix
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sparse-matrix">
       Sparse matrix
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrix-operations">
     1.2. Matrix operations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#addition">
       Addition
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scalar-multiplication">
       Scalar multiplication
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#hadamard-product">
       Hadamard product
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#matrix-multiplication">
       Matrix multiplication
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#transposition">
       Transposition
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#properties">
       Properties
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#diagonal-and-trace">
     1.3. Diagonal and trace
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-diagonal">
       The diagonal
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-trace">
       The trace
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#echelon-form-and-rank">
     1.4. Echelon form and rank
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#gaussian-elimination">
       Gaussian elimination
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#echelon-form">
       Echelon form
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#rank-nullity-theorem">
       Rank-nullity theorem
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#determinant-and-inverse">
     1.5. Determinant and inverse
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#minors-and-cofactors">
       Minors and cofactors
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#determinant">
       Determinant
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#inverse">
       Inverse
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eigenvalues">
     1.6. Eigenvalues
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#calculation">
       Calculation
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Properties
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#decomposition">
   2. Decomposition
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eigendecomposition">
     2.1. Eigendecomposition
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Properties
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#diagonalization">
       Diagonalization
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#svd">
     2.2. SVD
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Properties
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#qr-decomposition">
     2.3. QR decomposition
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#geometric-meaning">
   3. Geometric meaning
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#scalars">
     3.1. Scalars
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#column-vectors">
     3.2. Column vectors
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#square-matrices">
     3.3. Square matrices
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dot-product">
     3.4. Dot product
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     3.5. Determinant
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     3.6. Inverse
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Numpy: Linear Algebra</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-concepts">
   1. Basic concepts
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#special-matrices">
     1.1. Special matrices
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#constant-matrix">
       Constant matrix
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#square-matrix">
       Square matrix
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#unit-matrix">
       Unit matrix
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#diagonal-matrix">
       Diagonal matrix
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#triangular-matrix">
       Triangular matrix
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sparse-matrix">
       Sparse matrix
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrix-operations">
     1.2. Matrix operations
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#addition">
       Addition
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#scalar-multiplication">
       Scalar multiplication
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#hadamard-product">
       Hadamard product
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#matrix-multiplication">
       Matrix multiplication
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#transposition">
       Transposition
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#properties">
       Properties
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#diagonal-and-trace">
     1.3. Diagonal and trace
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-diagonal">
       The diagonal
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-trace">
       The trace
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#echelon-form-and-rank">
     1.4. Echelon form and rank
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#gaussian-elimination">
       Gaussian elimination
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#echelon-form">
       Echelon form
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#rank-nullity-theorem">
       Rank-nullity theorem
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#determinant-and-inverse">
     1.5. Determinant and inverse
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#minors-and-cofactors">
       Minors and cofactors
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#determinant">
       Determinant
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#inverse">
       Inverse
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eigenvalues">
     1.6. Eigenvalues
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#calculation">
       Calculation
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Properties
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#decomposition">
   2. Decomposition
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eigendecomposition">
     2.1. Eigendecomposition
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Properties
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#diagonalization">
       Diagonalization
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#svd">
     2.2. SVD
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Properties
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#qr-decomposition">
     2.3. QR decomposition
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#geometric-meaning">
   3. Geometric meaning
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#scalars">
     3.1. Scalars
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#column-vectors">
     3.2. Column vectors
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#square-matrices">
     3.3. Square matrices
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dot-product">
     3.4. Dot product
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     3.5. Determinant
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     3.6. Inverse
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="numpy-linear-algebra">
<h1>Numpy: Linear Algebra<a class="headerlink" href="#numpy-linear-algebra" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">eig</span><span class="p">,</span> <span class="n">inv</span><span class="p">,</span> <span class="n">matrix_power</span><span class="p">,</span> <span class="n">svd</span><span class="p">,</span> <span class="n">qr</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">([</span><span class="s1">&#39;seaborn&#39;</span><span class="p">,</span> <span class="s1">&#39;seaborn-whitegrid&#39;</span><span class="p">])</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39;
</pre></div>
</div>
</div>
</div>
<section id="basic-concepts">
<h2>1. Basic concepts<a class="headerlink" href="#basic-concepts" title="Permalink to this headline">#</a></h2>
<p>From now on, the following notations are applied:</p>
<ul class="simple">
<li><p>Regular, lowercase letters are used for <a class="reference external" href="https://en.wikipedia.org/wiki/Scalar_(mathematics)">scalars</a>. For example:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[x=5,\;\alpha=0.2\]</div>
<ul class="simple">
<li><p>Bold, lowercase letters are used for <a class="reference external" href="https://en.wikipedia.org/wiki/Row_and_column_vectors">column vectors</a>. Adding a number in square brackets specifies the entry in the corresponding position. For example:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{x}=\begin{bmatrix}2\\4\\5\end{bmatrix},\;\mathbf{x}[2]=4\end{split}\]</div>
<ul class="simple">
<li><p>For row vectors, add a transpose operator to the the column form. For example:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\mathbf{x}^{\text{T}}=\begin{bmatrix}2 &amp; 4 &amp; 5\end{bmatrix}\]</div>
<ul class="simple">
<li><p>Bold, uppercase letters are for <a class="reference external" href="https://en.wikipedia.org/wiki/Matrix_(mathematics)">matrices</a>. Adding <span class="math notranslate nohighlight">\(M\times N\)</span> as subscript indicates that the matrix has <span class="math notranslate nohighlight">\(M\)</span> rows and <span class="math notranslate nohighlight">\(N\)</span> columns. Adding <span class="math notranslate nohighlight">\(m,n\)</span> as subscript specifies the entry in the <span class="math notranslate nohighlight">\(m^{th}\)</span> row and the <span class="math notranslate nohighlight">\(n^{th}\)</span> column. For example:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{A}_{3\times4}=\begin{bmatrix}1&amp;2&amp;3&amp;4\\5&amp;6&amp;7&amp;8\\9&amp;10&amp;11&amp;12\end{bmatrix},\;\mathbf{A}_{2,3}=\mathbf{A}[2,3]=7\end{split}\]</div>
<section id="special-matrices">
<h3>1.1. Special matrices<a class="headerlink" href="#special-matrices" title="Permalink to this headline">#</a></h3>
<section id="constant-matrix">
<h4>Constant matrix<a class="headerlink" href="#constant-matrix" title="Permalink to this headline">#</a></h4>
<p>A constant matrix is a matrix where all elements are the same. Popular constant matrices are <a class="reference external" href="https://en.wikipedia.org/wiki/Zero_matrix">zero matrix</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/Matrix_of_ones">matrix of ones</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0, 0, 0, 0],
       [0, 0, 0, 0],
       [0, 0, 0, 0]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1, 1, 1, 1, 1, 1],
       [1, 1, 1, 1, 1, 1],
       [1, 1, 1, 1, 1, 1],
       [1, 1, 1, 1, 1, 1]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="square-matrix">
<h4>Square matrix<a class="headerlink" href="#square-matrix" title="Permalink to this headline">#</a></h4>
<p>A <a class="reference external" href="https://en.wikipedia.org/wiki/Square_matrix">square matrix</a> is a matrix with the same number of rows and columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.57084056, 0.19949711, 0.06148951],
       [0.57086295, 0.24929257, 0.0558644 ],
       [0.33376222, 0.36694373, 0.09584761]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0, 1, 2],
       [3, 4, 5],
       [6, 7, 8]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="unit-matrix">
<h4>Unit matrix<a class="headerlink" href="#unit-matrix" title="Permalink to this headline">#</a></h4>
<p>A <a class="reference external" href="https://en.wikipedia.org/wiki/Identity_matrix">unit matrix</a> (sometimes called identity matrix) is a square matrix with ones on the main diagonal and zeros elsewhere, denoted by <span class="math notranslate nohighlight">\(\mathbf{I}_N\)</span> where <span class="math notranslate nohighlight">\(N\)</span> is the length of each size.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1, 0, 0, 0, 0],
       [0, 1, 0, 0, 0],
       [0, 0, 1, 0, 0],
       [0, 0, 0, 1, 0],
       [0, 0, 0, 0, 1]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="diagonal-matrix">
<h4>Diagonal matrix<a class="headerlink" href="#diagonal-matrix" title="Permalink to this headline">#</a></h4>
<p>A <a class="reference external" href="https://en.wikipedia.org/wiki/Diagonal_matrix">diagonal matrix</a> is a square matrix in which the elements outside the main diagonal are all zero. Given <span class="math notranslate nohighlight">\(\mathbf{a}=\begin{bmatrix}1 &amp; 2 &amp; 3\end{bmatrix}^{\text{T}}\)</span>, a diagonal matrix can be represented as below:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}1&amp;0&amp;0 \\ 0&amp;2&amp;0 \\ 0&amp;0&amp;3 \end{bmatrix}=\text{diag}(\mathbf{a})=\text{diag}(1,2,3)\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">array</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[6, 0, 0, 0],
       [0, 8, 0, 0],
       [0, 0, 7, 0],
       [0, 0, 0, 4]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="triangular-matrix">
<h4>Triangular matrix<a class="headerlink" href="#triangular-matrix" title="Permalink to this headline">#</a></h4>
<p>A <a class="reference external" href="https://en.wikipedia.org/wiki/Triangular_matrix">triangular matrix</a> is a special kind of square matrix, where all entries above or below the main diagonal are <span class="math notranslate nohighlight">\(0\)</span>. There are two types of triangular matrix: lower and upper.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">tril</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1, 0, 0, 0],
       [7, 7, 0, 0],
       [9, 4, 2, 0],
       [2, 2, 1, 1]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[2, 2, 7, 7],
       [0, 9, 5, 8],
       [0, 0, 6, 1],
       [0, 0, 0, 0]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="sparse-matrix">
<h4>Sparse matrix<a class="headerlink" href="#sparse-matrix" title="Permalink to this headline">#</a></h4>
<p>Sparse matrix is a large matrix that most of its elements are zero. Our approach is to compress the sparse matrix to storing the non-zero values only (compressed sparse row (CSR) matrix). This leads to significant computational saving.</p>
<p>For example, imagine a matrix where every column is a Netflix movie and each row is a Netflix user, the values are how many times a user has watched a particular movie. That matrix would have thousands of columns and millions of rows. However, since most users have not watched most movies, the vast majority of the matrix values would be zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">large_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">large_matrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([0, 0, 1, 2, 2], dtype=int64), array([5, 8, 1, 0, 8], dtype=int64))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compressed_matrix</span> <span class="o">=</span> <span class="n">sicpy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">(</span><span class="n">large_matrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">compressed_matrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  (0, 5)	4
  (0, 8)	7
  (1, 1)	1
  (2, 0)	3
  (2, 8)	8
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="matrix-operations">
<h3>1.2. Matrix operations<a class="headerlink" href="#matrix-operations" title="Permalink to this headline">#</a></h3>
<section id="addition">
<h4>Addition<a class="headerlink" href="#addition" title="Permalink to this headline">#</a></h4>
<p>The matrices to be used in <a class="reference external" href="https://en.wikipedia.org/wiki/Matrix_addition">addition</a> (or subtraction) must be of the same shape. The sum of <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{M\times N}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{B}\in\mathbb{R}^{M\times N}\)</span> is calculated as:</p>
<div class="math notranslate nohighlight">
\[(\mathbf{A}+\mathbf{B})_{m,n} = \mathbf{A}_{m,n} + \mathbf{B}_{m,n}\qquad\text{for }m\in\{1,2,\dots,M\}\text{ and }n\in\{1,2,\dots,N\}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 8,  7, 11],
       [ 6,  5, 13]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">-</span> <span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 6,  3,  5],
       [-2, -5,  1]])
</pre></div>
</div>
</div>
</div>
<p>Alternatively, <code class="docutils literal notranslate"><span class="pre">np.add()</span></code> can be used.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 8,  7, 11],
       [ 6,  5, 13]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="scalar-multiplication">
<h4>Scalar multiplication<a class="headerlink" href="#scalar-multiplication" title="Permalink to this headline">#</a></h4>
<p>For a scalar <span class="math notranslate nohighlight">\(c\)</span> and a matrix <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{M\times N}\)</span>, the multiplication can be computed: <span class="math notranslate nohighlight">\((c\mathbf{A})_{m,n} = c\cdot \mathbf{A}_{m,n}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">*</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 2,  4,  6],
       [ 8, 10, 12]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="hadamard-product">
<h4>Hadamard product<a class="headerlink" href="#hadamard-product" title="Permalink to this headline">#</a></h4>
<p>Also known as <a class="reference external" href="https://en.wikipedia.org/wiki/Hadamard_product_(matrices)">element-wise product</a>, the Hadamard product of two matrices <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> of the same size <span class="math notranslate nohighlight">\(M\times N\)</span> is a matrix <span class="math notranslate nohighlight">\(\mathbf{C}\in\mathbb{R}^{M\times N}\)</span>.</p>
<div class="math notranslate nohighlight">
\[\mathbf{C}_{m,n}=\mathbf{A}_{m,n}\odot\mathbf{B}_{m,n}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1,  2,  3,  4],
       [ 5,  6,  7,  8],
       [ 9, 10, 11, 12]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 6,  7,  8,  9],
       [10, 11, 12, 13],
       [14, 15, 16, 18]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">*</span><span class="n">B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  6,  14,  24,  36],
       [ 50,  66,  84, 104],
       [126, 150, 176, 216]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="matrix-multiplication">
<h4>Matrix multiplication<a class="headerlink" href="#matrix-multiplication" title="Permalink to this headline">#</a></h4>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Matrix_multiplication">dot product</a> of <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{M\times N}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{B}\in\mathbb{R}^{N\times P}\)</span> is a matrix <span class="math notranslate nohighlight">\(\mathbf{C}\in\mathbb{R}^{M\times P}\)</span> where the element of <span class="math notranslate nohighlight">\(\mathbf{C}\)</span> in the <span class="math notranslate nohighlight">\(m^{th}\)</span> row and <span class="math notranslate nohighlight">\(p^{th}\)</span> column is calculated by the formula:
$<span class="math notranslate nohighlight">\(\mathbf{C}_{m,p} = \sum_{n=1}^N {\mathbf{A}_{m,n}\mathbf{B}_{n,p}}\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1, 2, 3],
       [4, 5, 6]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1,  2,  3,  4],
       [ 5,  6,  7,  8],
       [ 9, 10, 11, 12]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 38,  44,  50,  56],
       [ 83,  98, 113, 128]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">@</span> <span class="n">B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 38,  44,  50,  56],
       [ 83,  98, 113, 128]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="transposition">
<h4>Transposition<a class="headerlink" href="#transposition" title="Permalink to this headline">#</a></h4>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Transpose">Transposition</a> is an operator where the matrix is flipped over its diagonal. The transpose of the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{M\times N}\)</span> is denoted <span class="math notranslate nohighlight">\((\mathbf{A}^{\text{T}})\in\mathbb{R}^{N\times M}\)</span> and satisfies <span class="math notranslate nohighlight">\(\mathbf{A}_{m,n}\)</span> = <span class="math notranslate nohighlight">\((\mathbf{A}^{\text{T}})_{n,m}\)</span> for <span class="math notranslate nohighlight">\(m\in \{1,2,\dots,M\}\)</span> and <span class="math notranslate nohighlight">\(n\in\{1,2,\dots,N\}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0,  1,  2,  3,  4,  5,  6,  7],
       [ 8,  9, 10, 11, 12, 13, 14, 15],
       [16, 17, 18, 19, 20, 21, 22, 23]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0,  8, 16],
       [ 1,  9, 17],
       [ 2, 10, 18],
       [ 3, 11, 19],
       [ 4, 12, 20],
       [ 5, 13, 21],
       [ 6, 14, 22],
       [ 7, 15, 23]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ True,  True,  True])
</pre></div>
</div>
</div>
</div>
</section>
<section id="properties">
<h4>Properties<a class="headerlink" href="#properties" title="Permalink to this headline">#</a></h4>
<p>Here are some properties of matrix operations:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathbf{A}+\mathbf{B} = \mathbf{B}+\mathbf{A}\)</span> (commutativity)</p></li>
<li><p><span class="math notranslate nohighlight">\((c\mathbf{A})^{\text{T}} = c \cdot \mathbf{A}^{\text{T}}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\((\mathbf{A}+\mathbf{B})^{\text{T}} = \mathbf{A}^{\text{T}} + \mathbf{B}^{\text{T}}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\((\mathbf{A}^{\text{T}})^{\text{T}} = \mathbf{A}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\((\mathbf{A}\mathbf{B})\mathbf{C} = \mathbf{A}(\mathbf{B}\mathbf{C}) = \mathbf{A}\mathbf{B}\mathbf{C}\)</span> (associativity)</p></li>
<li><p><span class="math notranslate nohighlight">\((\mathbf{A}+\mathbf{B})\mathbf{C} = \mathbf{A}\mathbf{C} + \mathbf{B}\mathbf{C}\)</span> (distributivity)</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{A}\mathbf{B} \neq \mathbf{B}\mathbf{A}\)</span></p></li>
</ul>
</section>
</section>
<section id="diagonal-and-trace">
<h3>1.3. Diagonal and trace<a class="headerlink" href="#diagonal-and-trace" title="Permalink to this headline">#</a></h3>
<section id="the-diagonal">
<h4>The diagonal<a class="headerlink" href="#the-diagonal" title="Permalink to this headline">#</a></h4>
<p>To get the <a class="reference external" href="https://en.wikipedia.org/wiki/Main_diagonal">main diagonal</a> of a matrix, use the <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.diag.html"><code class="docutils literal notranslate"><span class="pre">np.diag()</span></code></a> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0,  5, 10])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 1,  6, 11])
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-trace">
<h4>The trace<a class="headerlink" href="#the-trace" title="Permalink to this headline">#</a></h4>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Trace_(linear_algebra)">trace</a> of a square matrix is the sum of the main diagonal elements. Despite that Numpy supports calculating the trace for any type of matrix, Mathematics defines the trace for square matrices only.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="echelon-form-and-rank">
<h3>1.4. Echelon form and rank<a class="headerlink" href="#echelon-form-and-rank" title="Permalink to this headline">#</a></h3>
<section id="gaussian-elimination">
<h4>Gaussian elimination<a class="headerlink" href="#gaussian-elimination" title="Permalink to this headline">#</a></h4>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Gaussian_elimination">Gaussian elimination</a> (also known as row reduction) is a linear algebra algorithm for solving a system of linear equations; finding the rank, the determinant and the inverse of matrices. There are three types of elementary matrix operations:</p>
<ul class="simple">
<li><p>Interchanging two rows</p></li>
<li><p>Multiplying a row by a non-zero number</p></li>
<li><p>Adding a multiple of a row to another row</p></li>
</ul>
</section>
<section id="echelon-form">
<h4>Echelon form<a class="headerlink" href="#echelon-form" title="Permalink to this headline">#</a></h4>
<p>Using Gaussian elimination, any matrix can be transformed to the <a class="reference external" href="https://en.wikipedia.org/wiki/Row_echelon_form">row echelon form</a> or column echelon form. From now on, echelon form refers to row echelon.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
    a &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
    0 &amp; 0 &amp; b &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
    0 &amp; 0 &amp; 0 &amp; c &amp; * &amp; * &amp; * &amp; * &amp; * \\
    0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; d &amp; * &amp; * \\
    0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; e &amp; * \\
    0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
\end{bmatrix}
\end{split}\]</div>
<p>A matrix is in echelon form when it satisfies the following conditions:</p>
<ul class="simple">
<li><p>All zero rows (rows with all zero elements) are at the bottom.</p></li>
<li><p>Each <a class="reference external" href="https://en.wikipedia.org/wiki/Pivot_element">pivot</a> (or leading entry) - the leftmost non-zero element of each row is always to the right of the above pivot. In the example above, <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(c\)</span>, <span class="math notranslate nohighlight">\(d\)</span> and <span class="math notranslate nohighlight">\(e\)</span> are pivots.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]]</span>
<span class="p">)</span>
<span class="kn">import</span> <span class="nn">scipy.linalg</span>
<span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">echelon</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lu</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">echelon</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 2. ,  7. ,  8. ],
       [ 0. , -1.5, -3. ],
       [ 0. ,  0. ,  0. ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">echelon</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 2,  7,  8],
       [ 0, -1, -3],
       [ 0,  0,  0]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="rank-nullity-theorem">
<h4>Rank-nullity theorem<a class="headerlink" href="#rank-nullity-theorem" title="Permalink to this headline">#</a></h4>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Rank_(linear_algebra)">rank</a> of a matrix is the highest number of linear independent rows in the matrix. A vector is linear dependent if it equals to the sum of scalar multiples of other vectors. The maximum rank of the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{M\times N}\)</span> is <span class="math notranslate nohighlight">\(\min(M,N)\)</span>. <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is said to be <em>full rank</em> if its rank reaches the maximum value and to be <em>rank deficient</em> otherwise. This can be expressed using the
<a class="reference external" href="https://en.wikipedia.org/wiki/Rank%E2%80%93nullity_theorem">rank-nullity theorem</a>:</p>
<div class="math notranslate nohighlight">
\[\text{rank}(A)+\text{nullity}(A)=\min(M,N)\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="determinant-and-inverse">
<h3>1.5. Determinant and inverse<a class="headerlink" href="#determinant-and-inverse" title="Permalink to this headline">#</a></h3>
<p>These attributes are defined only for square matrices.</p>
<section id="minors-and-cofactors">
<h4>Minors and cofactors<a class="headerlink" href="#minors-and-cofactors" title="Permalink to this headline">#</a></h4>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Minor_(linear_algebra)">minor</a> and the cofactor are required to calculate the determinant and the inverse of square matrices. Given a square matrix <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{N\times N}\)</span> and <span class="math notranslate nohighlight">\(i,j\in\{1,2,\dots,N\}\)</span>:</p>
<ul class="simple">
<li><p>The <span class="math notranslate nohighlight">\((i,j)\)</span> minor, denoted <span class="math notranslate nohighlight">\(m_{ij}\)</span>, is the determinant of the <span class="math notranslate nohighlight">\((N-1)\times(N-1)\)</span> <a class="reference external" href="https://proofwiki.org/wiki/Definition:Submatrix">sub-matrix</a> formed by deleting the <span class="math notranslate nohighlight">\(i^{th}\)</span> row and the <span class="math notranslate nohighlight">\(j^{th}\)</span> column.</p></li>
<li><p>The corresponding cofactor is <span class="math notranslate nohighlight">\(\mathbf{C}_{i,j}=(-1)^{i+j}\,m_{ij}\)</span>.</p></li>
</ul>
<p>From the calculated cofactors, we can build the matrix of cofactors (<a class="reference external" href="https://en.wikipedia.org/wiki/Adjugate_matrix">adjugate matrix</a>):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathbf{C} =
\begin{bmatrix}
\mathbf{C}_{1,1} &amp; \mathbf{C}_{1,2} &amp; \dots  &amp; \mathbf{C}_{1,n}\\
\mathbf{C}_{2,1} &amp; \mathbf{C}_{2,2} &amp; \dots  &amp; \mathbf{C}_{2,n}\\
\vdots  &amp; \vdots  &amp; \ddots &amp; \vdots \\
\mathbf{C}_{n,1} &amp; \mathbf{C}_{n,2} &amp; \dots  &amp; \mathbf{C}_{n,n}
\end{bmatrix}
\end{split}\]</div>
</section>
<section id="determinant">
<h4>Determinant<a class="headerlink" href="#determinant" title="Permalink to this headline">#</a></h4>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Determinant">determinant</a> of a <span class="math notranslate nohighlight">\(2\times 2\)</span> matrix is:
$</p>
<div class="amsmath math notranslate nohighlight" id="equation-b744b900-6055-407d-9a91-eedd6194d900">
<span class="eqno">(1)<a class="headerlink" href="#equation-b744b900-6055-407d-9a91-eedd6194d900" title="Permalink to this equation">#</a></span>\[\begin{vmatrix}
a_{1,1} &amp; a_{1,2}\\
a_{2,1} &amp; a_{2,2}
\end{vmatrix}\]</div>
<p>= a_{1,1}a_{2,2} - a_{1,2}a_{2,1}
$</p>
<p>To calculate the determinant of the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{N\times N}\)</span> (denoted <span class="math notranslate nohighlight">\(|\mathbf{A}|\)</span>), use the <a class="reference external" href="https://en.wikipedia.org/wiki/Laplace_expansion">Laplace formula</a> (a recursion with the base case of <span class="math notranslate nohighlight">\(N=2\)</span>):</p>
<div class="math notranslate nohighlight">
\[\det\left(\mathbf{A}\right) = |\mathbf{A}| = \sum_{i=1}^N a_{ij}(-1)^{i+j}m_{ij} = \sum_{i=1}^N a_{ij}C_{ij}\]</div>
<p>where: <span class="math notranslate nohighlight">\(i, j \in \{1,2,...,N\}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[6, 1, 4, 4, 8],
       [4, 6, 3, 5, 8],
       [7, 9, 9, 2, 7],
       [8, 8, 9, 2, 6],
       [9, 5, 4, 1, 4]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1553.0000000000011
</pre></div>
</div>
</div>
</div>
</section>
<section id="inverse">
<h4>Inverse<a class="headerlink" href="#inverse" title="Permalink to this headline">#</a></h4>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Invertible_matrix">inverse</a> of the square matrix <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{N\times N}\)</span> is denoted <span class="math notranslate nohighlight">\(\mathbf{A}^{-1}\)</span> and satisfies <span class="math notranslate nohighlight">\(\mathbf{A}\cdot\mathbf{A}^{-1} = \mathbf{I}_N\)</span> where <span class="math notranslate nohighlight">\(\mathbf{I}_N\)</span> is the unit matrix. <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is invertible only if <span class="math notranslate nohighlight">\(|\mathbf{A}| \ne 0\)</span>. The formula for inversion is:</p>
<div class="math notranslate nohighlight">
\[\mathbf{A}^{-1} = \frac{1}{|\mathbf{A}|}C^{\text{T}}\]</div>
<p>Infered from the above formula, a square matrix having determinant of <span class="math notranslate nohighlight">\(0\)</span> has no inverse. Such a matrix is called a <em>singular matrix</em>. Otherwise, the matrix is said to be <em>invertible</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-24.,  18.,   5.],
       [ 20., -15.,  -4.],
       [ -5.,   4.,   1.]])
</pre></div>
</div>
</div>
</div>
<p>Let’s check if the dot product of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{A}^{-1}\)</span> is an identity matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1, 0, 0],
       [0, 1, 0],
       [0, 0, 1]])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="eigenvalues">
<h3>1.6. Eigenvalues<a class="headerlink" href="#eigenvalues" title="Permalink to this headline">#</a></h3>
<section id="calculation">
<h4>Calculation<a class="headerlink" href="#calculation" title="Permalink to this headline">#</a></h4>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Eigenvalues_and_eigenvectors">Eigenvalues and eigenvectors</a> are defined only for square matrices. Each eigenvalue <span class="math notranslate nohighlight">\((\lambda)\)</span> and a corresponding eigenvector <span class="math notranslate nohighlight">\((\mathbf{x})\)</span> of the square matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> satisfies: <span class="math notranslate nohighlight">\(\mathbf{A}\mathbf{x} = \lambda \mathbf{x}\)</span>. To find eigenvalues and eigenvectors:</p>
<ul class="simple">
<li><p>Solve the equation: <span class="math notranslate nohighlight">\(|\mathbf{A} - \lambda \mathbf{I}| = \mathbf{0}\)</span> (called the <a class="reference external" href="https://en.wikipedia.org/wiki/Characteristic_polynomial">characteristic equation</a>) for <span class="math notranslate nohighlight">\(\lambda\)</span>.</p></li>
<li><p>For each value of <span class="math notranslate nohighlight">\(\lambda\)</span> found, solve the equation <span class="math notranslate nohighlight">\((\mathbf{A}-\lambda)\;\mathbf{x}=\mathbf{0}\)</span> or use Gaussian elimination to convert the <a class="reference external" href="https://en.wikipedia.org/wiki/Augmented_matrix">augmented matrix</a> <span class="math notranslate nohighlight">\((\mathbf{A} - \lambda \mathbf{I}\mid0)\)</span> to echelon form then solve it as a system of linear equations.</p></li>
</ul>
<p>Note that there are an infinite number of linear dependent eigenvectors associated with a single eigenvalue.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eigenvalues</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([3., 2., 1.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eigenvalues</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.000000000000002
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eigenvectors</span>
<span class="c1"># each column is an eigenvector</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.4082,  0.    ,  0.7071],
       [-0.4082,  0.4472, -0.    ],
       [-0.8165,  0.8944,  0.7071]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eigenvectors</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-0.4082, -0.4082, -0.8165])
</pre></div>
</div>
</div>
</div>
<p>Now calculate the value of <span class="math notranslate nohighlight">\(\mathbf{A}\mathbf{x}\)</span> and <span class="math notranslate nohighlight">\(\lambda \mathbf{x}\)</span> and check if they are equal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lhs</span> <span class="o">=</span> <span class="n">A</span> <span class="o">@</span> <span class="n">eigenvectors</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">rhs</span> <span class="o">=</span> <span class="n">eigenvalues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">eigenvectors</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h4>Properties<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h4>
<p>Here are some properties of eigenvalues:</p>
<ul class="simple">
<li><p>The sum of all eigenvalues is the same as the trace of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>.</p></li>
<li><p>The product of all eigenvalues is the same as the determinant of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>.</p></li>
<li><p>The number of eigenvalues equals to the rank of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{A}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{A}^T\)</span> have the same set of eigenvalues.</p></li>
</ul>
</section>
</section>
</section>
<section id="decomposition">
<h2>2. Decomposition<a class="headerlink" href="#decomposition" title="Permalink to this headline">#</a></h2>
<section id="eigendecomposition">
<h3>2.1. Eigendecomposition<a class="headerlink" href="#eigendecomposition" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Eigendecomposition_of_a_matrix">Eigendecomposition</a> of a square matrix <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{N\times N}\)</span> is the factorization that is based on its eigenvalues and eigenvectors and is only applied for <a class="reference external" href="https://en.wikipedia.org/wiki/Diagonalizable_matrix">non-defective matrices</a> (matrices that are diagonizable). <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> can be written as:</p>
<div class="math notranslate nohighlight">
\[\mathbf{A}=\mathbf{Q}\mathbf{D}\mathbf{Q}^{-1}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">)</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">eigenvectors</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lhs</span> <span class="o">=</span> <span class="n">A</span>
<span class="n">rhs</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">@</span> <span class="n">D</span> <span class="o">@</span> <span class="n">inv</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h4>Properties<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h4>
<ul class="simple">
<li><p>We can easily prove that: <span class="math notranslate nohighlight">\(\mathbf{A}^k=\mathbf{Q}\mathbf{D}^k\mathbf{Q}^{-1}\)</span>. By letting <span class="math notranslate nohighlight">\(k=-1\)</span>, this property can be used to compute the inverse of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>.</p></li>
<li><p>When <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is a <a class="reference external" href="https://en.wikipedia.org/wiki/Symmetric_matrix">symmetric matrix</a> (<span class="math notranslate nohighlight">\(\mathbf{A}=\mathbf{A}^{\text{T}}\)</span>), it is always diagonalizable and its eigenvectors are <a class="reference external" href="https://en.wikipedia.org/wiki/Orthonormality">orthonormal</a>. Thus, <span class="math notranslate nohighlight">\(\mathbf{Q}\)</span> becomes an <a class="reference external" href="https://en.wikipedia.org/wiki/Orthogonal_matrix">orthogonal matrix</a>. This wonderful property is the foundation of famous PCA (Principle Components Analysis).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">power</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">lhs</span> <span class="o">=</span> <span class="n">matrix_power</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">power</span><span class="p">)</span>
<span class="n">rhs</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">@</span> <span class="n">matrix_power</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">power</span><span class="p">)</span> <span class="o">@</span> <span class="n">inv</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="diagonalization">
<h4>Diagonalization<a class="headerlink" href="#diagonalization" title="Permalink to this headline">#</a></h4>
<p>Diagonalization is the process of transform a square matrix to a diagonal matrix so that it retains the main properties. By performing eigendecomposition, we are diagonalizing <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> into <span class="math notranslate nohighlight">\(\mathbf{D}\)</span>. Let’s analyze the situation to understand how <span class="math notranslate nohighlight">\(\mathbf{D}\)</span> shares the same characteristics with <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    \mathbf{Ax} &amp;= \mathbf{y} \\
    \Leftrightarrow\mathbf{Q}\mathbf{D}\mathbf{Q}^{-1}\mathbf{x} &amp;= \mathbf{y} \\
    \Leftrightarrow\mathbf{D}\left(\mathbf{Q}^{-1}\mathbf{x}\right) &amp;= \left(\mathbf{Q}^{-1}\mathbf{y}\right)
\end{aligned}
\end{split}\]</div>
<p>In the first equation, <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> is the image of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> in the new coordinates system proposed by <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>. In the third equation, notice that both <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> are transformed in the same way. We can conclude that <span class="math notranslate nohighlight">\(\mathbf{D}\)</span> represents the simplest form of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> that requires less entries (<span class="math notranslate nohighlight">\(N\)</span> instead of <span class="math notranslate nohighlight">\(N^2\)</span>).</p>
</section>
</section>
<section id="svd">
<h3>2.2. SVD<a class="headerlink" href="#svd" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Singular_value_decomposition">Singular Value Decomposition</a> (SVD) is the generalization of eigendecomposition of a square matrix to any rectangular matrix. In Machine Learning, it has a lot of applications such as finding <a class="reference external" href="https://en.wikipedia.org/wiki/Moore%E2%80%93Penrose_inverse">pseudo-inverse</a> and solving for <a class="reference external" href="https://en.wikipedia.org/wiki/Total_least_squares">least squares</a> problems. SVD says that any matrix <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{M\times N}\)</span> can be factorized into:</p>
<div class="math notranslate nohighlight">
\[\mathbf{A}=\mathbf{U}\mathbf{S}\mathbf{V}^{\text{T}}\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathbf{U}\in\mathbb{R}^{M\times M}\)</span> stores the eigenvectors of <span class="math notranslate nohighlight">\(\mathbf{A}\mathbf{A}^{\text{T}}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{V}\in\mathbb{R}^{N\times N}\)</span> stores the eigenvectors of <span class="math notranslate nohighlight">\(\mathbf{A}^{\text{T}}\mathbf{A}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{S}\in\mathbb{R}^{M\times N}\)</span> is a diagonal matrix with singular values lying on the diagonal</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
<span class="p">])</span>

<span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Vh</span> <span class="o">=</span> <span class="n">svd</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.6253, -0.453 ,  0.6354],
       [-0.5556, -0.3133, -0.7702],
       [-0.548 ,  0.8346,  0.0558]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Vh</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.368 , -0.5351, -0.455 , -0.6093],
       [-0.1257, -0.781 ,  0.3991,  0.4637],
       [-0.8789,  0.295 , -0.1142,  0.3571],
       [ 0.2763, -0.1293, -0.7878,  0.535 ]])
</pre></div>
</div>
</div>
</div>
<section id="id3">
<h4>Properties<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h4>
<p>Notice that both <span class="math notranslate nohighlight">\(\mathbf{A}\mathbf{A}^{\text{T}}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{A}^{\text{T}}\mathbf{A}\)</span> are symmetric matrices, thus their eigenvectors are orthogonal. As <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{V}\)</span> are constructed of these vectors, we call them orthogonal matrices. An orthogonal matrix is unitary:</p>
<div class="math notranslate nohighlight">
\[\mathbf{U}\mathbf{U}^{\text{T}}=\mathbf{U}\mathbf{U}^{-1}=\mathbf{I}\]</div>
<p><span class="math notranslate nohighlight">\(\mathbf{A}\mathbf{A}^{\text{T}}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{A}^{\text{T}}\mathbf{A}\)</span> in fact share the same set of positive eigenvalues. It turns out, their square roots are the singular values which lies on the diagonal of <span class="math notranslate nohighlight">\(\mathbf{S}\)</span>. This relationship can be expressed using the eigendecomposition of either <span class="math notranslate nohighlight">\(\mathbf{A}\mathbf{A}^{\text{T}}\)</span> or <span class="math notranslate nohighlight">\(\mathbf{A}^{\text{T}}\mathbf{A}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\mathbf{A}\mathbf{A}^{\text{T}}
&amp;= \left(\mathbf{U}\mathbf{S}\mathbf{V}^{\text{T}}\right)\left(\mathbf{U}\mathbf{S}\mathbf{V}^{\text{T}}\right)^{\text{T}} \\
&amp;= \mathbf{U}\mathbf{S}\mathbf{V}^{\text{T}}\mathbf{V}\mathbf{S}^{\text{T}}\mathbf{U}^{\text{T}} \\
&amp;= \mathbf{U}(\mathbf{S}\mathbf{S}^{\text{T}})\mathbf{U}^{-1} \\
\end{aligned}\end{split}\]</div>
<p>As <span class="math notranslate nohighlight">\(\mathbf{S}\)</span> is a diagonal matrix, to calculate <span class="math notranslate nohighlight">\(\mathbf{S}\mathbf{S}^{\text{T}}\)</span> we only need to square the elements on the diagonal of <span class="math notranslate nohighlight">\(\mathbf{S}\)</span>. In other words, squaring singular values of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> gives us the eigenvalues of <span class="math notranslate nohighlight">\(\mathbf{A}\mathbf{A}^{\text{T}}\)</span>.</p>
</section>
</section>
<section id="qr-decomposition">
<h3>2.3. QR decomposition<a class="headerlink" href="#qr-decomposition" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/QR_decomposition">QR decomposition</a> of a matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is the factorization into a product of an orthogonal matrix <span class="math notranslate nohighlight">\(\mathbf{Q}\)</span> and an upper triangular matrix <span class="math notranslate nohighlight">\(\mathbf{R}\)</span>. It is solved using <a class="reference external" href="https://en.wikipedia.org/wiki/Gram%E2%80%93Schmidt_process">Gram-Schmidt process</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="p">])</span>

<span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">qr</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.5657,  0.6646,  0.4882],
       [-0.7071, -0.0863, -0.7018],
       [-0.4243, -0.7422,  0.5187]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ -7.0711, -10.4652,  -8.061 ],
       [  0.    ,   4.6347,  -2.8826],
       [  0.    ,   0.    ,   2.7768]])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="geometric-meaning">
<h2>3. Geometric meaning<a class="headerlink" href="#geometric-meaning" title="Permalink to this headline">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_vectors</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="n">num_vectors</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">initial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_vectors</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">initial</span><span class="p">,</span> <span class="n">data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">default</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">default</span><span class="p">,</span> <span class="n">data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">data</span>

    <span class="n">edge</span> <span class="o">=</span> <span class="mf">0.5</span>
    
    <span class="n">right</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">u</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">right</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">right</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">right</span> <span class="o">+=</span> <span class="n">edge</span>
    
    <span class="n">left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">u</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">left</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">left</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">left</span> <span class="o">-=</span> <span class="n">edge</span>
    
    <span class="n">upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">upper</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">upper</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">upper</span> <span class="o">+=</span> <span class="n">edge</span>
    
    <span class="n">lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">lower</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">lower</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">lower</span> <span class="o">-=</span> <span class="n">edge</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
        <span class="n">units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;scaled&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="scalars">
<h3>3.1. Scalars<a class="headerlink" href="#scalars" title="Permalink to this headline">#</a></h3>
<p>A scalar <span class="math notranslate nohighlight">\(c\)</span> when times a vector <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> has the following effects:</p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(|c|&gt;1\)</span> then <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> stretches, if <span class="math notranslate nohighlight">\(|c|&lt;1\)</span> then <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> shrinks.</p></li>
<li><p>The sign of <span class="math notranslate nohighlight">\(c\)</span> tells us the direction of the new vector: positive means same direction, negative means opposite direction.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;deepskyblue&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;coral&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">plot_vectors</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/numpy-linear-algebra_113_0.png"><img alt="../_images/numpy-linear-algebra_113_0.png" class="align-center" src="../_images/numpy-linear-algebra_113_0.png" style="width: 479.0px; height: 274.0px;" /></a>
</div>
</div>
</section>
<section id="column-vectors">
<h3>3.2. Column vectors<a class="headerlink" href="#column-vectors" title="Permalink to this headline">#</a></h3>
<p>In a 2-dimensional <span class="math notranslate nohighlight">\(xy\)</span>-coordinates, we conventionally call <span class="math notranslate nohighlight">\(\mathbf{i}_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf{i}_2\)</span> the <a class="reference external" href="https://en.wikipedia.org/wiki/Basis_(linear_algebra)">basis/unit vectors</a>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{i}_1=\begin{bmatrix}1\\0\end{bmatrix},\;\mathbf{i}_2=\begin{bmatrix}0\\1\end{bmatrix}\end{split}\]</div>
<p>Any vector <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> can always be represented by these basis vectors, for example:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{a}=\begin{bmatrix}3\\2\end{bmatrix}=3\mathbf{i}_1+2\mathbf{i}_2\end{split}\]</div>
<p>Note that there are an infinite number of representations of <span class="math notranslate nohighlight">\(\mathbf{a}\)</span>. By convention, I use the origin as the <em>initial point</em> for all vectors. In other words, only the <em>terminal point</em> is neccessary to represent a vector.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;deepskyblue&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;coral&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;coral&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">plot_vectors</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/numpy-linear-algebra_115_0.png"><img alt="../_images/numpy-linear-algebra_115_0.png" class="align-center" src="../_images/numpy-linear-algebra_115_0.png" style="width: 425.5px; height: 329.5px;" /></a>
</div>
</div>
</section>
<section id="square-matrices">
<h3>3.3. Square matrices<a class="headerlink" href="#square-matrices" title="Permalink to this headline">#</a></h3>
<p>A square matrix represents a <em>change</em> of basis vectors. For example, let’s consider the matrix:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{A}=\begin{bmatrix}2&amp;1\\0&amp;3\end{bmatrix}\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(\mathbf{A}\)</span> represents a new coordinates system, in which <span class="math notranslate nohighlight">\((\mathbf{a}_1,\mathbf{a}_2)\)</span> become the new basis:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{a}_1=\begin{bmatrix}2\\0\end{bmatrix},\;\mathbf{a}_2=\begin{bmatrix}1\\3\end{bmatrix}\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;coral&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;coral&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">plot_vectors</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/numpy-linear-algebra_117_0.png"><img alt="../_images/numpy-linear-algebra_117_0.png" class="align-center" src="../_images/numpy-linear-algebra_117_0.png" style="width: 251.0px; height: 329.5px;" /></a>
</div>
</div>
</section>
<section id="dot-product">
<h3>3.4. Dot product<a class="headerlink" href="#dot-product" title="Permalink to this headline">#</a></h3>
<p>In this part, we are going to discover the geometric meaning of the dot a product between a square matrix <span class="math notranslate nohighlight">\(\mathbf{A}_{N\times N}\)</span> with a column vector <span class="math notranslate nohighlight">\(\mathbf{b}_{N\times 1}\)</span>. As far as we know, a square matrix can be thought as a <em>container</em> of new basis, where each column represents a basis vector:
<span class="math notranslate nohighlight">\(\mathbf{A}=[\mathbf{a}_1,\mathbf{a}_2,\dots,\mathbf{a}_N]\)</span>.
For a specific case of <span class="math notranslate nohighlight">\(N=2\)</span>, the dot product <span class="math notranslate nohighlight">\(\mathbf{Ab}\)</span> is derived as follow:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathbf{A}\mathbf{b} =
\begin{bmatrix}\begin{array}{r} 2&amp;-1 \\ 0&amp;1 \end{array}\end{bmatrix}
\begin{bmatrix}\begin{array}{r} 3 \\ 4 \end{array}\end{bmatrix}
=
3\begin{bmatrix}\begin{array}{r} 2 \\ 0 \end{array}\end{bmatrix} +
4\begin{bmatrix}\begin{array}{r} -1 \\ 1 \end{array}\end{bmatrix}
=
3\mathbf{a}_1+4\mathbf{a}_2
\end{split}\]</div>
<p>By treating <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> as a set of new basis vectors, <span class="math notranslate nohighlight">\((\mathbf{a}_1,\mathbf{a}_2)\)</span>, we can now construct a brand new coordinates system. The geometric meaning of the product <span class="math notranslate nohighlight">\(\mathbf{Ab}\)</span> is where <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> points to in the new coordinates. A special case of dot product is when <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is a unit matrix, then we have <span class="math notranslate nohighlight">\(\mathbf{b}=\mathbf{A}\mathbf{b}\)</span>. This equation tells us a unit matrix is just the same old representation of the original basis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;deepskyblue&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;coral&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;coral&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">plot_vectors</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/numpy-linear-algebra_119_0.png"><img alt="../_images/numpy-linear-algebra_119_0.png" class="align-center" src="../_images/numpy-linear-algebra_119_0.png" style="width: 473.0px; height: 233.5px;" /></a>
</div>
</div>
</section>
<section id="id4">
<h3>3.5. Determinant<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h3>
<p>The determinant of a matrix
<span class="math notranslate nohighlight">\(\mathbf{M}_{2\times 2}=\begin{bmatrix}\begin{array}{r} a&amp;c \\ b&amp;d \end{array}\end{bmatrix}\)</span>
is the area of the <a class="reference external" href="https://en.wikipedia.org/wiki/Parallelogram">parallellogram</a> formed by new basis vectors.</p>
<a class="reference internal image-reference" href="../_images/parallellogram.png"><img alt="../_images/parallellogram.png" class="align-center" src="../_images/parallellogram.png" style="height: 270px;" /></a>
<p>For the matrix
<span class="math notranslate nohighlight">\(\mathbf{R}_{3\times 3}=\left[\begin{array}{c|c|c|c}\mathbf{r}_1 &amp; \mathbf{r}_2 &amp; \mathbf{r}_3\end{array}\right]\)</span>,
its determinant is the volume of the <a class="reference external" href="https://en.wikipedia.org/wiki/Parallelepiped">parallelepiped</a> formed by 3 new basis vectors.</p>
<a class="reference internal image-reference" href="../_images/parallelepiped.png"><img alt="../_images/parallelepiped.png" class="align-center" src="../_images/parallelepiped.png" style="height: 270px;" /></a>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A square matrix has the determinant of <span class="math notranslate nohighlight">\(0\)</span> only when there is at least one of its vectors is <em>linear dependent</em> on the others. Assume the matrix <span class="math notranslate nohighlight">\(\mathbf{R}_{3\times 3}\)</span> above has the determinant of <span class="math notranslate nohighlight">\(0\)</span>, then it can be one of the following situations:</p>
<ul class="simple">
<li><p>There are at least one vector is <span class="math notranslate nohighlight">\(\mathbf{0}\)</span></p></li>
<li><p>There are at least a pair of vectors is parallel</p></li>
<li><p>All three vectors lies in the same plane</p></li>
</ul>
<p>Basically, if <span class="math notranslate nohighlight">\(\det\left(\mathbf{R}\right)=0\)</span> then the new coordinates system has less than 3 dimensions.</p>
</div>
</section>
<section id="id5">
<h3>3.6. Inverse<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h3>
<p>If a matrix <span class="math notranslate nohighlight">\(\mathbf{A}_{N\times N}\)</span> changes the basis, then <span class="math notranslate nohighlight">\(\mathbf{A}^{-1}\)</span> is the inverse transform that changes back to the old coordinates. The reason behind this is the equation <span class="math notranslate nohighlight">\(\mathbf{A}\cdot\mathbf{A}^{-1} = \mathbf{I}_N\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(\det\left(\mathbf{A}\right)=0\)</span> then <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> maps the original coordinates into a new, lower dimensional space. In this case, the inverse transform cannot be performed; in other words, <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is  <em>non-invertible</em>.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "hungpq7/tabular-book",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapter-02"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="numpy-arrays.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Numpy: Arrays</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="sympy-calculus.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Sympy: Calculus</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Quang Hung &#9829; Thuy Linh<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>