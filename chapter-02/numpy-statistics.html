
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Numpy: Statistics</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Scipy: Hypothesis Testing" href="scipy-hypothesis-testing.html" />
    <link rel="prev" title="Numpy: Probability" href="numpy-probability.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.svg" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../util/intro.html">
                    Data Science
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-01/_intro.html">
   <b>
    1. Python Programming
   </b>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-01/python-basic-concepts.html">
     Python: Basic Concepts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-01/python-data-types.html">
     Python: Data Types
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-01/python-data-containers.html">
     Python: Data Containers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-01/python-functions-objects.html">
     Python: Functions and Objects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-01/python-external-sources.html">
     Python: External Sources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-01/selenium-web-scraping.html">
     Selenium: Web Scraping
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="_intro.html">
   <b>
    2. Mathematics
   </b>
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="numpy-linear-algebra.html">
     Numpy: Linear Algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sympy-calculus.html">
     Sympy: Calculus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="numpy-probability.html">
     Numpy: Probability
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Numpy: Statistics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="scipy-hypothesis-testing.html">
     Scipy: Hypothesis Testing
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-03/_intro.html">
   <b>
    3. Data Manipulation
   </b>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-03/numpy-arrays.html">
     Numpy: Arrays
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-03/pandas-data-exploratory.html">
     Pandas: Data Exploratory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-03/pandas-data-cleaning.html">
     Pandas: Data Cleaning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-03/pandas-data-transformation.html">
     Pandas: Data Transformation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-03/janitor-pandas-extensions.html">
     Janitor: Pandas Extensions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-04/_intro.html">
   <b>
    4. Big Data
   </b>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-04/hiveql-data-manipulation.html">
     HiveQL: Data Manipulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-04/pyspark-data-exploratory.html">
     PySpark: Data Exploratory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-04/pyspark-data-cleaning.html">
     PySpark: Data Cleaning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-04/pyspark-data-transformation.html">
     PySpark: Data Transformation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-04/dask-parallelized-pandas.html">
     Dask: Parallelized Pandas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-05/_intro.html">
   <b>
    5. Data Visualization
   </b>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-05/matplotlib-graph-construction.html">
     Matplotlib: Graph Construction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-05/seaborn-statistical-visualization.html">
     Seaborn: Statistical Visualization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-05/plotly-interactive-visualization.html">
     Plotly: Interactive Visualization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-07/_intro.html">
   <b>
    7. Tabular Learning
   </b>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-07/sklearn-ensemble-learning.html">
     Sklearn: Ensemble Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-07/xgboost-tree-boosting.html">
     XGBoost: Tree Boosting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-07/ray-hyperparameter-optimization.html">
     Ray: Hyperparam Optimization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-07/shap-model-interpretation.html">
     Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-07/imblearn-targeted-modeling.html">
     1. Imbalanced learning
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../chapter-10/_intro.html">
   <b>
    10. Deep Learning
   </b>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter-10/numpy-gradient-descent.html">
     Python: Gradient Descent
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/hungpq7/tabular-book/master?urlpath=tree/chapter-02/numpy-statistics.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/hungpq7/tabular-book/blob/master/chapter-02/numpy-statistics.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/hungpq7/tabular-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/chapter-02/numpy-statistics.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#descriptive-statisics">
   1. Descriptive statisics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basic-statistics">
     1.1. Basic statistics
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variance">
     1.2. Variance
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#unbiased-variance">
       Unbiased variance
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#variance-and-mean">
       Variance and mean
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#visualization-of-variance">
       Visualization of variance
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#skewness">
     1.3. Skewness
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#kurtosis">
     1.4. Kurtosis
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#quantiles">
     1.5. Quantiles
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#median">
       Median
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#quartiles">
       Quartiles
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#popular-quantiles">
       Popular quantiles
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#correlation-coefficient">
     1.6. Correlation coefficient
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#covariance">
       Covariance
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Correlation coefficient
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#probability-plots">
     1.7. Probability plots
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#p-p-plot">
       P-P plot
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#q-q-plot">
       Q-Q plot
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#estimation">
   2. Estimation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#point-estimation">
     2.1. Point estimation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#method-of-moments">
       Method of moments
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#maximum-likelihood">
       Maximum likelihood
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interval-estimation">
     2.2. Interval estimation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mean-estimation">
       Mean estimation
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#proportion-estimation">
       Proportion estimation
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#variance-estimation">
       Variance estimation
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#statistical-models">
   3. Statistical models
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#binary-dependent-regression">
     3.1. Binary dependent regression
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#logit-model">
       Logit model
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#probit-model">
       Probit model
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#panel-data-regression">
     3.2. Panel data regression
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#fixed-effects-model">
       Fixed effects model
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#random-effects-model">
       Random effects model
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Numpy: Statistics</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#descriptive-statisics">
   1. Descriptive statisics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basic-statistics">
     1.1. Basic statistics
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variance">
     1.2. Variance
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#unbiased-variance">
       Unbiased variance
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#variance-and-mean">
       Variance and mean
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#visualization-of-variance">
       Visualization of variance
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#skewness">
     1.3. Skewness
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#kurtosis">
     1.4. Kurtosis
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#quantiles">
     1.5. Quantiles
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#median">
       Median
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#quartiles">
       Quartiles
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#popular-quantiles">
       Popular quantiles
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#correlation-coefficient">
     1.6. Correlation coefficient
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#covariance">
       Covariance
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Correlation coefficient
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#probability-plots">
     1.7. Probability plots
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#p-p-plot">
       P-P plot
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#q-q-plot">
       Q-Q plot
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#estimation">
   2. Estimation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#point-estimation">
     2.1. Point estimation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#method-of-moments">
       Method of moments
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#maximum-likelihood">
       Maximum likelihood
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interval-estimation">
     2.2. Interval estimation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mean-estimation">
       Mean estimation
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#proportion-estimation">
       Proportion estimation
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#variance-estimation">
       Variance estimation
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#statistical-models">
   3. Statistical models
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#binary-dependent-regression">
     3.1. Binary dependent regression
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#logit-model">
       Logit model
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#probit-model">
       Probit model
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#panel-data-regression">
     3.2. Panel data regression
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#fixed-effects-model">
       Fixed effects model
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#random-effects-model">
       Random effects model
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="numpy-statistics">
<h1>Numpy: Statistics<a class="headerlink" href="#numpy-statistics" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">statsmodels.tools</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">statsmodels.discrete.discrete_model</span> <span class="kn">import</span> <span class="n">Logit</span><span class="p">,</span> <span class="n">Probit</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">([</span><span class="s1">&#39;seaborn&#39;</span><span class="p">,</span> <span class="s1">&#39;seaborn-whitegrid&#39;</span><span class="p">])</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39;
</pre></div>
</div>
</div>
</div>
<section id="descriptive-statisics">
<h2>1. Descriptive statisics<a class="headerlink" href="#descriptive-statisics" title="Permalink to this headline">#</a></h2>
<section id="basic-statistics">
<h3>1.1. Basic statistics<a class="headerlink" href="#basic-statistics" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>109
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>996
</pre></div>
</div>
</div>
</div>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Arithmetic_mean">mean</a> (denoted <span class="math notranslate nohighlight">\(\mu\)</span>) or the <a class="reference external" href="https://en.wikipedia.org/wiki/Expected_value">expected value</a> (denoted <span class="math notranslate nohighlight">\(\mathbb{E}[\mathbf{x}]\)</span>) of a variable <span class="math notranslate nohighlight">\(\mathbf{x}=(x_1,x_2,\dots,x_N)\)</span> is calculated by the formula:</p>
<div class="math notranslate nohighlight">
\[\mu = \frac{1}{N} \sum_{n=1}^{N}{x_n}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>57069
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>570.69
</pre></div>
</div>
</div>
</div>
</section>
<section id="variance">
<h3>1.2. Variance<a class="headerlink" href="#variance" title="Permalink to this headline">#</a></h3>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Variance">variance</a> of a random variable <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> is defined as:
$<span class="math notranslate nohighlight">\(\sigma^2 = \frac{1}{N}\sum_{n=1}^N{(x_n - \mu)}^2\)</span>$
where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\sigma\)</span> is the <a class="reference external" href="https://en.wikipedia.org/wiki/Standard_deviation">standard deviation</a> of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma^2\)</span> is the variance of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mu\)</span> is the mean of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(N\)</span> is the size of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(x_n\)</span> is the <span class="math notranslate nohighlight">\(n^{th}\)</span> observation</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># standard deviation</span>
<span class="n">sample</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>270.7422647094465
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># variance</span>
<span class="n">sample</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>73301.37389999999
</pre></div>
</div>
</div>
</div>
<section id="unbiased-variance">
<h4>Unbiased variance<a class="headerlink" href="#unbiased-variance" title="Permalink to this headline">#</a></h4>
<p>In many practical situations, <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> is just a sample and the true variance of the whole population is unknown. <span class="math notranslate nohighlight">\(\sigma_{\mathbf{x}}^2\)</span> in this case is an <a class="reference external" href="https://en.wikipedia.org/wiki/Bias_of_an_estimator">biased estimator</a>, it usually underestimates the population variance. Correting for this bias yields:</p>
<div class="math notranslate nohighlight">
\[\hat{\sigma}^2 = \frac{1}{N-1}\sum_{n=1}^N{(x_n - \mu)}^2\]</div>
<p>The use of the term <span class="math notranslate nohighlight">\(N-1\)</span> is under <a class="reference external" href="https://en.wikipedia.org/wiki/Bessel%27s_correction">Bessel’s correction</a>. The quantity <span class="math notranslate nohighlight">\(1\)</span> subtracted from <span class="math notranslate nohighlight">\(N\)</span> is the <a class="reference external" href="https://en.wikipedia.org/wiki/Degrees_of_freedom_(statistics)">degrees of freedom</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>74041.79181818181
</pre></div>
</div>
</div>
</div>
</section>
<section id="variance-and-mean">
<h4>Variance and mean<a class="headerlink" href="#variance-and-mean" title="Permalink to this headline">#</a></h4>
<p>The following formula demonstrates the relationship between the mean and the variance:</p>
<div class="math notranslate nohighlight">
\[\sigma^2 = E\left[(\mathbf{x} - E[\mathbf{x}])^2\right] = E[\mathbf{x}^2] - E[\mathbf{x}]^2\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>73301.37389999995
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualization-of-variance">
<h4>Visualization of variance<a class="headerlink" href="#visualization-of-variance" title="Permalink to this headline">#</a></h4>
<p>Standard deviation and variance show how spread out numbers are.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>

<span class="n">std_1</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">sample_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">std_1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">sample_1</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;indianred&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Standard deviation = </span><span class="si">{</span><span class="n">std_1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">std_2</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">sample_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">std_2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">sample_2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Standard deviation = </span><span class="si">{</span><span class="n">std_2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/numpy-statistics_22_0.png"><img alt="../_images/numpy-statistics_22_0.png" class="align-center" src="../_images/numpy-statistics_22_0.png" style="width: 384.0px; height: 531.5px;" /></a>
</div>
</div>
</section>
</section>
<section id="skewness">
<h3>1.3. Skewness<a class="headerlink" href="#skewness" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Skewness">Skewness</a> is a measure of the asymmetry of a random variable about its mean. A skewness of <span class="math notranslate nohighlight">\(0\)</span> indicates that the variable is symmetrically distributed. There are several approaches for calculating skewness (denoted <span class="math notranslate nohighlight">\(\gamma\)</span>); however, the Fisher’s coefficient is the go-to one:</p>
<div class="math notranslate nohighlight">
\[\gamma=\frac{m_3}{m_2^{3/2}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\displaystyle{m_i=\frac{1}{N}\sum{(\mathbf{x}-\mu)^i}}\)</span> is the <span class="math notranslate nohighlight">\(i^{th}\)</span> <a class="reference external" href="https://en.wikipedia.org/wiki/Central_moment">central moment</a>. In estimating the population skewness, we multiply the biased formula by the factor <span class="math notranslate nohighlight">\(\displaystyle{\frac{\sqrt{N(N-1)}}{N-2}}\)</span> where <span class="math notranslate nohighlight">\(N\)</span> is the sample size.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="n">sample1</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">skewnorm</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">loc</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">sample2</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">skewnorm</span><span class="p">(</span><span class="n">a</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">sample3</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">skewnorm</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">legend</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sa">f</span><span class="s1">&#39;Skewness = </span><span class="si">{</span><span class="n">stats</span><span class="o">.</span><span class="n">skew</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">; right skewed&#39;</span><span class="p">,</span>
    <span class="sa">f</span><span class="s1">&#39;Skewness = </span><span class="si">{</span><span class="n">stats</span><span class="o">.</span><span class="n">skew</span><span class="p">(</span><span class="n">sample2</span><span class="p">)</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">; left skewed&#39;</span><span class="p">,</span>
    <span class="sa">f</span><span class="s1">&#39;Skewness = </span><span class="si">{</span><span class="n">stats</span><span class="o">.</span><span class="n">skew</span><span class="p">(</span><span class="n">sample3</span><span class="p">)</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">; symmetric&#39;</span>
<span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;indianred&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">sample2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;steelblue&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">sample3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/numpy-statistics_25_0.png"><img alt="../_images/numpy-statistics_25_0.png" class="align-center" src="../_images/numpy-statistics_25_0.png" style="width: 686.0px; height: 329.5px;" /></a>
</div>
</div>
<p>Note that the side of the skewness refers to the side of the longer tail. In the graph above, the red sample is said to be right skewed since the mass of its distribution is concentrated to the left, leading to a longer right tail.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">skew</span>
<span class="nb">print</span><span class="p">(</span><span class="n">skew</span><span class="p">(</span><span class="n">sample1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">skew</span><span class="p">(</span><span class="n">sample2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8267742492928277
-0.8123928593355433
</pre></div>
</div>
</div>
</div>
</section>
<section id="kurtosis">
<h3>1.4. Kurtosis<a class="headerlink" href="#kurtosis" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Kurtosis">Kurtosis</a> is a measure of peakedness of a distribution. The calculation of kurtosis (denoted <span class="math notranslate nohighlight">\(\kappa\)</span>) is given by Fisher’s definition:</p>
<div class="math notranslate nohighlight">
\[\kappa=\frac{m_4}{m_2^2}-3\]</div>
<p>where <span class="math notranslate nohighlight">\(m_i\)</span> is the <span class="math notranslate nohighlight">\(i^{th}\)</span> <a class="reference external" href="https://en.wikipedia.org/wiki/Central_moment">central moment</a> (<span class="math notranslate nohighlight">\(m_2\)</span> is the variance). The quantity <span class="math notranslate nohighlight">\(3\)</span> is subtracted from the result to give a skewness of <span class="math notranslate nohighlight">\(0\)</span> for a normal distribution. When estimating the population kurtosis, we use the corrected formula:</p>
<div class="math notranslate nohighlight">
\[\hat{\kappa}=\frac{N-1}{(N-2)(N-3)}\left[(N+1)\frac{m_4}{m_2^2}-3(N-1)\right]\]</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="n">d1</span><span class="p">,</span> <span class="n">d2</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span>
<span class="n">sample1</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">sample2</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">loc</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">sample3</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">sample1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;indianred&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Kurtosis = </span><span class="si">{</span><span class="n">stats</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(</span><span class="n">sample1</span><span class="p">)</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">sample2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;steelblue&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Kurtosis = </span><span class="si">{</span><span class="n">stats</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(</span><span class="n">sample2</span><span class="p">)</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">sample3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Kurtosis = </span><span class="si">{</span><span class="n">stats</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(</span><span class="n">sample3</span><span class="p">)</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/numpy-statistics_30_0.png"><img alt="../_images/numpy-statistics_30_0.png" class="align-center" src="../_images/numpy-statistics_30_0.png" style="width: 607.0px; height: 329.5px;" /></a>
</div>
</div>
</section>
<section id="quantiles">
<h3>1.5. Quantiles<a class="headerlink" href="#quantiles" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Quantile">Quantiles</a> are the <span class="math notranslate nohighlight">\(q-1\)</span> cut points dividing a set of values into <span class="math notranslate nohighlight">\(q\)</span> subsets of equal probability. Some common <span class="math notranslate nohighlight">\(q\)</span>-quantiles are <a class="reference external" href="https://en.wikipedia.org/wiki/Median">median</a> (<span class="math notranslate nohighlight">\(2\)</span>-quantile), <a class="reference external" href="https://en.wikipedia.org/wiki/Quartile">quartiles</a> (<span class="math notranslate nohighlight">\(4\)</span>-quantiles), deciles (<span class="math notranslate nohighlight">\(10\)</span>-quantiles) and <a class="reference external" href="https://en.wikipedia.org/wiki/Percentile">percentiles</a> (<span class="math notranslate nohighlight">\(100\)</span>-quantiles).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="median">
<h4>Median<a class="headerlink" href="#median" title="Permalink to this headline">#</a></h4>
<p>There are 50% of data points smaller than the median and 50% of data points greater than the median.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>599.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="quartiles">
<h4>Quartiles<a class="headerlink" href="#quartiles" title="Permalink to this headline">#</a></h4>
<p><span class="math notranslate nohighlight">\(Q_1\)</span>, <span class="math notranslate nohighlight">\(Q_2\)</span>, <span class="math notranslate nohighlight">\(Q_3\)</span> are the 3 quartiles that split our sample into 4 equal parts. There 25% of data points smaller than <span class="math notranslate nohighlight">\(Q_1\)</span>, 50% of the points smaller than <span class="math notranslate nohighlight">\(Q_2\)</span> and 75% points smaller than <span class="math notranslate nohighlight">\(Q_3\)</span>. Notice that <span class="math notranslate nohighlight">\(Q_2\)</span> is also known as the median. A <a class="reference external" href="https://en.wikipedia.org/wiki/Box_plot">box plot</a> is usually used to visualize quartiles.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([300.25, 599.  , 807.5 ])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># unpacking quartiles</span>
<span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">q3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">q3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>

<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">sample</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/numpy-statistics_39_0.png"><img alt="../_images/numpy-statistics_39_0.png" class="align-center" src="../_images/numpy-statistics_39_0.png" style="width: 279.2px; height: 195.60000000000002px;" /></a>
</div>
</div>
</section>
<section id="popular-quantiles">
<h4>Popular quantiles<a class="headerlink" href="#popular-quantiles" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([156.8, 186.7, 269.4, 855. , 936. , 950.9])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="correlation-coefficient">
<h3>1.6. Correlation coefficient<a class="headerlink" href="#correlation-coefficient" title="Permalink to this headline">#</a></h3>
<section id="covariance">
<h4>Covariance<a class="headerlink" href="#covariance" title="Permalink to this headline">#</a></h4>
<p>First, we calculate the <a class="reference external" href="https://en.wikipedia.org/wiki/Covariance">covariance</a> (denoted <span class="math notranslate nohighlight">\(\sigma_{\mathbf{x},\mathbf{y}}\)</span>) of bivariate data, which is a measure of joint variability.</p>
<div class="math notranslate nohighlight">
\[\sigma_{\mathbf{x},\mathbf{y}} =
\frac{1}{N} \sum_{n=1}^{N} {(x_n-\mu_\mathbf{x})\cdot (y_n-\mu_\mathbf{y})} =
E[(\mathbf{x}-E[\mathbf{x}])\cdot(\mathbf{y}-E[\mathbf{y}])]
\]</div>
<p>where <span class="math notranslate nohighlight">\(E[\mathbf{x}]\)</span> or <span class="math notranslate nohighlight">\(E[\mathbf{y}]\)</span> is the expected value of the corresponding variable.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">numpy.cov()</span></code> function returns the <a class="reference external" href="https://en.wikipedia.org/wiki/Covariance_matrix">covariance matrix</a> of <span class="math notranslate nohighlight">\(D\)</span> variables: <span class="math notranslate nohighlight">\(\mathbf{x}_1,\mathbf{x}_2,\dots,\mathbf{x}_D\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 659.16666667, -128.16666667,   93.5       ],
       [-128.16666667,  664.76666667,  -57.1       ],
       [  93.5       ,  -57.1       ,  823.43333333]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h4>Correlation coefficient<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h4>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient">Correlation coefficient</a> (denoted <span class="math notranslate nohighlight">\(\rho_{\mathbf{x},\mathbf{y}}\)</span>) is the normalized version of covariance. By using the <a class="reference external" href="https://en.wikipedia.org/wiki/Cauchy%E2%80%93Schwarz_inequality">Cauchy-Schwarz inequality</a>, it’s easy to proof that <span class="math notranslate nohighlight">\(\rho_{\mathbf{x},\mathbf{y}} \in [-1; 1]\)</span>. The closer the coefficient is to either -1 or 1, the stronger the correlation between the two variables.</p>
<div class="math notranslate nohighlight">
\[\rho_{\mathbf{x},\mathbf{y}} = \frac{\sigma_{\mathbf{x},\mathbf{y}}}{\sigma_\mathbf{x} \sigma_\mathbf{y}}\]</div>
<p>The <code class="docutils literal notranslate"><span class="pre">numpy.corrcoef()</span></code> function returns the correlation coefficient matrix of <span class="math notranslate nohighlight">\(D\)</span> variables: <span class="math notranslate nohighlight">\(\mathbf{x}_1,\mathbf{x}_2,\dots,\mathbf{x}_D\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.        , -0.19361672,  0.12691115],
       [-0.19361672,  1.        , -0.07717689],
       [ 0.12691115, -0.07717689,  1.        ]])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="probability-plots">
<h3>1.7. Probability plots<a class="headerlink" href="#probability-plots" title="Permalink to this headline">#</a></h3>
<p>Probability plots are used to compare the distributions of two datasets. The possible comparing scenarios using probability plots are:</p>
<ul class="simple">
<li><p>Comparing two empirical sets</p></li>
<li><p>Comapring a empirical set and a theoretical set</p></li>
<li><p>Comparing two theoretical sets</p></li>
</ul>
<p>The most common case is the middle one - when we want to assess whether the observed data comes from a specified distribution.</p>
<section id="p-p-plot">
<h4>P-P plot<a class="headerlink" href="#p-p-plot" title="Permalink to this headline">#</a></h4>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/P%E2%80%93P_plot">P-P plot</a> (probability-probability plot) is a visualization that plots CDFs of two distributions against each other. If points are on the line (<span class="math notranslate nohighlight">\(x=y\)</span>) then 2 CDF are the same and observed values is under expected distribution. P-P plot is suitable for comparing probability distributions that have a nearby location because it requires the loc and scale parameters of theoretical distribution.</p>
<ul class="simple">
<li><p>In <span class="math notranslate nohighlight">\(x\)</span> axis: Estimated cummulative proportions of empirical distribution, given <span class="math notranslate nohighlight">\(r_n\)</span> is the rank of observed values</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{PE}=\frac{r_n-0.5}{N}\]</div>
<ul class="simple">
<li><p>In <span class="math notranslate nohighlight">\(y\)</span> axis: Expected cummulative probabilities of theoretical distribution (CDF corresponding to observed values)</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">PPPlot</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">dist</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
    <span class="n">var</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
    <span class="n">pe</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>
    <span class="n">pp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">var</span><span class="p">))</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pe</span><span class="p">,</span> <span class="n">pp</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;steelblue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;scaled&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Observed variable&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Theoretical distribution&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;P-P Plot&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Histogram&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">PPPlot</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/numpy-statistics_54_0.png"><img alt="../_images/numpy-statistics_54_0.png" class="align-center" src="../_images/numpy-statistics_54_0.png" style="width: 678.5px; height: 280.5px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">PPPlot</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/numpy-statistics_55_0.png"><img alt="../_images/numpy-statistics_55_0.png" class="align-center" src="../_images/numpy-statistics_55_0.png" style="width: 678.5px; height: 280.5px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">PPPlot</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/numpy-statistics_56_0.png"><img alt="../_images/numpy-statistics_56_0.png" class="align-center" src="../_images/numpy-statistics_56_0.png" style="width: 678.5px; height: 280.5px;" /></a>
</div>
</div>
</section>
<section id="q-q-plot">
<h4>Q-Q plot<a class="headerlink" href="#q-q-plot" title="Permalink to this headline">#</a></h4>
<p>Similarity to P-P plot, Q-Q plot (quantile-quantile) is used to compare distribution by plotting their quantile agains each other. But Q-Q plot doesn’t require loc and scale parameter and the reference line is based on location and scale of theoretical distribution. QQ plot is suitable for tails of distribution (when probabilty density is low)</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">QQPlot</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">dist</span><span class="p">):</span>
    <span class="c1"># var = stats.zscore(var)</span>
    <span class="n">var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">size</span>
    <span class="n">cut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">quantileVar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">cut</span><span class="p">)</span>
    <span class="n">quantileDist</span> <span class="o">=</span> <span class="p">[</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">cut</span><span class="p">]</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">quantileDist</span><span class="p">,</span> <span class="n">quantileDist</span><span class="p">,</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">quantileVar</span><span class="p">,</span> <span class="n">quantileDist</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;steelblue&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;scaled&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Q-Q Plot&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Observed quantile&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Theoretical quantile&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Histogram&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">QQPlot</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/numpy-statistics_59_0.png"><img alt="../_images/numpy-statistics_59_0.png" class="align-center" src="../_images/numpy-statistics_59_0.png" style="width: 678.5px; height: 280.5px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">skewnorm</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">QQPlot</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/numpy-statistics_60_0.png"><img alt="../_images/numpy-statistics_60_0.png" class="align-center" src="../_images/numpy-statistics_60_0.png" style="width: 677.5px; height: 280.5px;" /></a>
</div>
</div>
</section>
</section>
</section>
<section id="estimation">
<h2>2. Estimation<a class="headerlink" href="#estimation" title="Permalink to this headline">#</a></h2>
<p>In statistic, estimation is the process which calculates approximately the unknown parameters of population based on information of a sample. Population means and propotions are two common parameters in estimations</p>
<section id="point-estimation">
<h3>2.1. Point estimation<a class="headerlink" href="#point-estimation" title="Permalink to this headline">#</a></h3>
<p>A point estimate of a population parameter is a single value of a statistic</p>
<section id="method-of-moments">
<h4>Method of moments<a class="headerlink" href="#method-of-moments" title="Permalink to this headline">#</a></h4>
<p>Simple idea of moments method is let the population moments are equal to expected sample moments.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Bias_of_an_estimator">Biased/unbiased estimation</a>: the bias of an estimator is the difference between this estimator’s expected value and the true value of the parameter being estimated. An estimator with zero bias is called unbiased. Statistic <span class="math notranslate nohighlight">\(\hat{\theta}\)</span> of sample is called unbiased of parameter <span class="math notranslate nohighlight">\(\theta\)</span> of population if: <span class="math notranslate nohighlight">\(E(\hat{\theta})=\theta\)</span></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Efficiency_(statistics)">Efficient estimation</a>: Statistic <span class="math notranslate nohighlight">\(\hat{\theta}\)</span> of sample is called most efficiency estimate if it is a unbiased estimator and it has the smallest variance between all unbiased estimators was build on the same sample</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Robust_statistics">Robust estimation</a>: In a large sample, if <span class="math notranslate nohighlight">\(\hat{\theta}\)</span> converge to <span class="math notranslate nohighlight">\(\theta\)</span> when <span class="math notranslate nohighlight">\(n \rightarrow \infty\)</span> then it was called robust estimator</p></li>
</ul>
</section>
<section id="maximum-likelihood">
<h4>Maximum likelihood<a class="headerlink" href="#maximum-likelihood" title="Permalink to this headline">#</a></h4>
<p>The idea of this method is estimating the unknown parameters which made the distribution best fit with the observed data.</p>
<p>Assume we have <span class="math notranslate nohighlight">\(N\)</span> observations <span class="math notranslate nohighlight">\(\mathbf{x} = (x_1, x_2, \dots ,x_N)\)</span> that come with distribution <span class="math notranslate nohighlight">\(f\)</span> and the vector of parameters <span class="math notranslate nohighlight">\(\mathbf{w}=(w_1, w_2,\dots, w_N)\)</span>. We have to find vector <span class="math notranslate nohighlight">\(\mathbf{w}\)</span> to maximize the likelihood function <span class="math notranslate nohighlight">\(\hat{\mathbf{w}} = \arg\max L(\mathbf{w})\)</span>. The likelihood function is:</p>
<div class="math notranslate nohighlight">
\[L(\mathbf{w}) = P(\mathbf{x}|\mathbf{w}) = P(x_1, x_2,\dots,x_N|\mathbf{w}) = \prod^N_{n=1} P(x_n|\mathbf{w})\]</div>
<p>To make the estimation of <span class="math notranslate nohighlight">\(\mathbf{w}\)</span> easier, the log likelihood function is used in this case, then the parameters would be:</p>
<div class="math notranslate nohighlight">
\[\log L(\mathbf{w})=\sum_{n=1}^N \log P(x_n|\mathbf{w})\]</div>
<div class="seealso admonition">
<p class="admonition-title">Case study</p>
<p>Having the spending data of 100 customers in the table below. Assume that money is normal distributed with confidence level 95%. Point estimate for mean of spending of all customer.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;spend&#39;</span><span class="p">:[</span><span class="mi">10</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">34</span><span class="p">],</span>
    <span class="s1">&#39;num_cus&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
<span class="p">})</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>spend</th>
      <th>num_cus</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>14</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18</td>
      <td>25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>22</td>
      <td>29</td>
    </tr>
    <tr>
      <th>4</th>
      <td>26</td>
      <td>21</td>
    </tr>
    <tr>
      <th>5</th>
      <td>30</td>
      <td>7</td>
    </tr>
    <tr>
      <th>6</th>
      <td>34</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;sale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;spend&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;num_cus&#39;</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">sale</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;num_cus&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>22.04
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="interval-estimation">
<h3>2.2. Interval estimation<a class="headerlink" href="#interval-estimation" title="Permalink to this headline">#</a></h3>
<p>An interval estimate is defined by two numbers, which the statistic lies between. The interval estimation of a statistic <span class="math notranslate nohighlight">\(\theta\)</span> is found in the <a class="reference external" href="https://en.wikipedia.org/wiki/Confidence_interval">confidence interval</a> <span class="math notranslate nohighlight">\((\theta_1,\theta_2)\)</span> where the probability that the statistic lies within the that interval is large enough to trust the result.</p>
<div class="math notranslate nohighlight">
\[P(\theta_1&lt;\theta&lt;\theta_2)=1-\alpha\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span> is the significance level and <span class="math notranslate nohighlight">\(\gamma=1-\alpha\)</span> is the confidence level</p></li>
<li><p><span class="math notranslate nohighlight">\(\theta_1\)</span> and <span class="math notranslate nohighlight">\(\theta_2\)</span> are lower and upper bounds, they are estimated base on a specific distribution</p></li>
</ul>
<section id="mean-estimation">
<h4>Mean estimation<a class="headerlink" href="#mean-estimation" title="Permalink to this headline">#</a></h4>
<p>When estimating the mean of a large sample, the critical value follows a standard normal distribution: <span class="math notranslate nohighlight">\(c\sim\mathcal{N}(0,1)\)</span>. However when the the sample size is too small (<span class="math notranslate nohighlight">\(N\leq30\)</span>), a  t-distribution with <span class="math notranslate nohighlight">\(N-1\)</span> degree of freedom is used instead to make sample variance closer to population variance: <span class="math notranslate nohighlight">\(c\sim\text{t}(N-1)\)</span>.</p>
<div class="math notranslate nohighlight">
\[
\hat{\mu}-\epsilon
&lt;\mu&lt;
\hat{\mu}+\epsilon
\qquad\text{for }\epsilon=c_{\alpha/2}\frac{\hat{\sigma}}{\sqrt{N}}
\]</div>
<p>When estimating the difference in means of two samples (they should be large enough), we simply extend the previous case:</p>
<div class="math notranslate nohighlight">
\[
(\hat{\mu}_1-\hat{\mu}_2)-\epsilon
&lt;\mu_1-\mu_2&lt;
(\hat{\mu}_1-\hat{\mu}_2)+\epsilon
\qquad\text{for }\epsilon=c_{\alpha/2}\sqrt{\frac{\hat{\sigma}_1^2}{N_1}+\frac{\hat{\sigma}_2^2}{N_2}}
\]</div>
<div class="seealso admonition">
<p class="admonition-title">Case study</p>
<p><span class="math notranslate nohighlight">\(20\)</span> book stores have their mean of book price <span class="math notranslate nohighlight">\(135.8\)</span> USD and variance <span class="math notranslate nohighlight">\(23.2\)</span>. With the confidence level of <span class="math notranslate nohighlight">\(95\%\)</span>, what is the range that market price of book should be in?</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span>
<span class="n">n</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">135.8</span><span class="p">,</span> <span class="mf">23.2</span>

<span class="c1"># instead of looking at the t table, we use Scipy to compute the critical value</span>
<span class="n">crit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">eps</span> <span class="o">=</span> <span class="n">crit</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
<span class="n">lower</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">-</span> <span class="n">eps</span>
<span class="n">upper</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">eps</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">gamma</span><span class="si">:</span><span class="s1">.0%</span><span class="si">}</span><span class="s1"> confidence interval is (</span><span class="si">{</span><span class="n">lower</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">upper</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>95% confidence interval is (133.55, 138.05)
</pre></div>
</div>
</div>
</div>
<div class="seealso admonition">
<p class="admonition-title">Case study</p>
<p>A random sample of <span class="math notranslate nohighlight">\(120\)</span> students yields mean GPA <span class="math notranslate nohighlight">\(2.71\)</span> with standard deviation <span class="math notranslate nohighlight">\(0.43\)</span>. Construct a <span class="math notranslate nohighlight">\(90\%\)</span> confidence interval for mean GPA of all students in that university.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">gamma</span>
<span class="n">n</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="mi">120</span><span class="p">,</span> <span class="mf">2.71</span><span class="p">,</span> <span class="mf">0.43</span>

<span class="n">crit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">eps</span> <span class="o">=</span> <span class="n">crit</span> <span class="o">*</span> <span class="n">std</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">lower</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">-</span> <span class="n">eps</span>
<span class="n">upper</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">eps</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">gamma</span><span class="si">:</span><span class="s1">.0%</span><span class="si">}</span><span class="s1"> confidence interval is (</span><span class="si">{</span><span class="n">lower</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">upper</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>90% confidence interval is (2.65, 2.77)
</pre></div>
</div>
</div>
</div>
</section>
<section id="proportion-estimation">
<h4>Proportion estimation<a class="headerlink" href="#proportion-estimation" title="Permalink to this headline">#</a></h4>
<p>When estimating the proportion of a population given sample proportion (<span class="math notranslate nohighlight">\(\hat{p}\)</span>), we use a critical value follows a standard normal distribution: <span class="math notranslate nohighlight">\(c\sim\mathcal{N}(0,1)\)</span></p>
<div class="math notranslate nohighlight">
\[
\hat{p}-\epsilon
&lt;p&lt;
\hat{p}+\epsilon
\qquad\text{for }\epsilon=c_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{N}}
\]</div>
<p>Like interval estimation for mean, we can also extend proportion estimation for the case of two samples:</p>
<div class="math notranslate nohighlight">
\[
(\hat{p}_1-\hat{p}_2)-\epsilon
&lt;p_1-p_2&lt;
(\hat{p}_1-\hat{p}_2)+\epsilon
\qquad\text{for }\epsilon=c_{\alpha/2}\sqrt{\frac{\hat{p}_1(1-\hat{p}_1)}{N_1}+\frac{\hat{p}_2(1-\hat{p}_2)}{N_2}}
\]</div>
<div class="seealso admonition">
<p class="admonition-title">Case study</p>
<p>To estimate the proportion of students at a large college who are female, a random sample of <span class="math notranslate nohighlight">\(N=120\)</span> students is selected. There are <span class="math notranslate nohighlight">\(69\)</span>  female students in the sample. Construct a <span class="math notranslate nohighlight">\(90\%\)</span>  confidence interval for the proportion of all students at the college who are female.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">gamma</span>
<span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">69</span><span class="o">/</span><span class="mi">120</span>

<span class="n">crit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">eps</span> <span class="o">=</span> <span class="n">crit</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>
<span class="n">lower</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span> <span class="n">eps</span>
<span class="n">upper</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="n">eps</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">gamma</span><span class="si">:</span><span class="s1">.0%</span><span class="si">}</span><span class="s1"> confidence interval is (</span><span class="si">{</span><span class="n">lower</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">upper</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>90% confidence interval is (0.50, 0.65)
</pre></div>
</div>
</div>
</div>
</section>
<section id="variance-estimation">
<h4>Variance estimation<a class="headerlink" href="#variance-estimation" title="Permalink to this headline">#</a></h4>
<p>When estimating population variance, the critical value follows a chi-squared distribution with <span class="math notranslate nohighlight">\(N-1\)</span> degrees of freedom: <span class="math notranslate nohighlight">\(c\sim\chi^2(N-1)\)</span>.</p>
<div class="math notranslate nohighlight">
\[
\frac{N-1}{c_{\alpha/2}}\hat{\sigma}^2
&lt;\sigma^2&lt;
\frac{N-1}{c_{1-\alpha/2}}\hat{\sigma}^2
\]</div>
<p>To estimate the ratio of two variances, we use a critical value that follows an F-distribution with <span class="math notranslate nohighlight">\(N-1\)</span> and <span class="math notranslate nohighlight">\(N-2\)</span> degrees of freedom: <span class="math notranslate nohighlight">\(c\sim \text{F}(N_1-1,N_2-1)\)</span>.</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{c_{\alpha/2}}\frac{\hat{\sigma}_1^2}{\hat{\sigma}_2^2}
&lt;\frac{\sigma_1^2}{\sigma_2^2}&lt;
c_{\alpha/2}\frac{\hat{\sigma}_1^2}{\hat{\sigma}_2^2}
\]</div>
<div class="seealso admonition">
<p class="admonition-title">Case study</p>
<p>A candy company targets to produces candy packs of exactly <span class="math notranslate nohighlight">\(52\)</span> grams. In attemp to estimate the variance of all packs, a quality control manager takes a random sample of <span class="math notranslate nohighlight">\(10\)</span> packs, it yields the variance of <span class="math notranslate nohighlight">\(4.2\)</span>. Use that sample to derive a <span class="math notranslate nohighlight">\(95\%\)</span> confidence interval for <span class="math notranslate nohighlight">\(\sigma\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">gamma</span>
<span class="n">n</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">4.2</span>

<span class="n">dist</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">chi2</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">crit1</span><span class="p">,</span> <span class="n">crit2</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">dist</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">lower</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">var</span> <span class="o">/</span> <span class="n">crit1</span>
<span class="n">upper</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">var</span> <span class="o">/</span> <span class="n">crit2</span>

<span class="c1"># confidence interval for standard deviation</span>
<span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lower</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">gamma</span><span class="si">:</span><span class="s1">.0%</span><span class="si">}</span><span class="s1"> confidence interval is (</span><span class="si">{</span><span class="n">lower</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">upper</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>95% confidence interval is (1.41, 3.74)
</pre></div>
</div>
</div>
</div>
<div class="seealso admonition">
<p class="admonition-title">Case study</p>
<p>Two spider species, deinopis and menneus, coexist in eastern Australia. Collect a sample of <span class="math notranslate nohighlight">\(10\)</span> preys for each species, we obtained the standard deviations of prey size (in millimeters) are <span class="math notranslate nohighlight">\(2.51\)</span> and <span class="math notranslate nohighlight">\(1.9\)</span>, respectively. Estimate, with <span class="math notranslate nohighlight">\(95\%\)</span> confidence, the ratio of two population variances.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">gamma</span>
<span class="n">n1</span><span class="p">,</span> <span class="n">var1</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">2.51</span><span class="o">**</span><span class="mi">2</span>
<span class="n">n2</span><span class="p">,</span> <span class="n">var2</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">1.9</span><span class="o">**</span><span class="mi">2</span>

<span class="n">crit</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="n">n1</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">lower</span> <span class="o">=</span> <span class="n">var1</span> <span class="o">/</span> <span class="n">var2</span> <span class="o">/</span> <span class="n">crit</span>
<span class="n">upper</span> <span class="o">=</span> <span class="n">var1</span> <span class="o">/</span> <span class="n">var2</span> <span class="o">*</span> <span class="n">crit</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">gamma</span><span class="si">:</span><span class="s1">.0%</span><span class="si">}</span><span class="s1"> confidence interval is (</span><span class="si">{</span><span class="n">lower</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">upper</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>95% confidence interval is (0.43, 7.03)
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="statistical-models">
<h2>3. Statistical models<a class="headerlink" href="#statistical-models" title="Permalink to this headline">#</a></h2>
<section id="binary-dependent-regression">
<h3>3.1. Binary dependent regression<a class="headerlink" href="#binary-dependent-regression" title="Permalink to this headline">#</a></h3>
<p>If we use linear function with probability is dependent variable, this will not restrict <span class="math notranslate nohighlight">\(P\)</span> to lie between 0 and 1. Then we need to use a <em>nonlinear function</em> to model the conditional probability function of a binary dependent variable. Commonly used methods are Probit and Logit regression.</p>
<section id="logit-model">
<h4>Logit model<a class="headerlink" href="#logit-model" title="Permalink to this headline">#</a></h4>
<p>Logistic model is used to describe the probability of a certain class such as true/false, good/bad,… The difference between logistic and linear regression is the output of logistic is limited in <span class="math notranslate nohighlight">\((0,1)\)</span>. Logistic function is the CDF of logistically distribution:</p>
<div class="math notranslate nohighlight">
\[p = \frac{1}{1+\exp{(-(\beta_0+\beta_1x))}}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span>: probability of 1 class</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_0, \beta_1,\dots\)</span>: model parameters</p></li>
</ul>
<p>Logistic function can be rewritten to <em>logit function</em>:</p>
<div class="math notranslate nohighlight">
\[\log\left(\frac{p}{1-p}\right) = \beta_0+\beta_1x\]</div>
<p>where <span class="math notranslate nohighlight">\(\dfrac{p}{1-p}\)</span> is called the odds ratio. Logit model in statistic doesn’t show the effect of independent variable <span class="math notranslate nohighlight">\(x\)</span> on <span class="math notranslate nohighlight">\(y\)</span>, it considers the influence of <span class="math notranslate nohighlight">\(x\)</span> on the probability to <span class="math notranslate nohighlight">\(y\)</span> get the values 1 (expected value of <span class="math notranslate nohighlight">\(y\)</span>).</p>
</section>
<section id="probit-model">
<h4>Probit model<a class="headerlink" href="#probit-model" title="Permalink to this headline">#</a></h4>
<p>In probit model, the CDF of standard normal distribution is used to model the regression:</p>
<div class="math notranslate nohighlight">
\[P(Y=1\vert X) = \Phi(\beta_0 + \beta_1 X_1 + \dots + \beta_k X_k)\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Phi\)</span>: The CDF of standard normal distribution</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_0 + \beta_1 X + \dots + \beta_k X_k\)</span>: quantile <span class="math notranslate nohighlight">\(z^*\)</span> where <span class="math notranslate nohighlight">\(\Phi(z^*) = P(Z \leq z^*) \ , \ Z \sim \mathcal{N}(0,1)\)</span></p></li>
</ul>
<p>The coefficient <span class="math notranslate nohighlight">\(\beta_j\)</span> of probit model have the same meaning with logit model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/logit_dataset.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>labor_join</th>
      <th>chil5</th>
      <th>chil618</th>
      <th>age</th>
      <th>wif_college</th>
      <th>hus_college</th>
      <th>log_wage</th>
      <th>fam_income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>32</td>
      <td>0</td>
      <td>0</td>
      <td>1.210165</td>
      <td>10.910001</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>30</td>
      <td>0</td>
      <td>0</td>
      <td>0.328504</td>
      <td>19.500000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>35</td>
      <td>0</td>
      <td>0</td>
      <td>1.514128</td>
      <td>12.039999</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>34</td>
      <td>0</td>
      <td>0</td>
      <td>0.092115</td>
      <td>6.800000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>31</td>
      <td>1</td>
      <td>0</td>
      <td>1.524280</td>
      <td>20.100000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;labor_join&#39;</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;labor_join&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">logit</span> <span class="o">=</span> <span class="n">Logit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="n">logit</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.601106
         Iterations 6
</pre></div>
</div>
<div class="output text_html"><table class="simpletable">
<caption>Logit Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>      <td>labor_join</td>    <th>  No. Observations:  </th>  <td>   753</td>  
</tr>
<tr>
  <th>Model:</th>                 <td>Logit</td>      <th>  Df Residuals:      </th>  <td>   745</td>  
</tr>
<tr>
  <th>Method:</th>                 <td>MLE</td>       <th>  Df Model:          </th>  <td>     7</td>  
</tr>
<tr>
  <th>Date:</th>            <td>Wed, 10 Aug 2022</td> <th>  Pseudo R-squ.:     </th>  <td>0.1209</td>  
</tr>
<tr>
  <th>Time:</th>                <td>10:46:13</td>     <th>  Log-Likelihood:    </th> <td> -452.63</td> 
</tr>
<tr>
  <th>converged:</th>             <td>True</td>       <th>  LL-Null:           </th> <td> -514.87</td> 
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>  LLR p-value:       </th> <td>8.923e-24</td>
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>    3.1821</td> <td>    0.644</td> <td>    4.938</td> <td> 0.000</td> <td>    1.919</td> <td>    4.445</td>
</tr>
<tr>
  <th>chil5</th>       <td>   -1.4629</td> <td>    0.197</td> <td>   -7.426</td> <td> 0.000</td> <td>   -1.849</td> <td>   -1.077</td>
</tr>
<tr>
  <th>chil618</th>     <td>   -0.0646</td> <td>    0.068</td> <td>   -0.950</td> <td> 0.342</td> <td>   -0.198</td> <td>    0.069</td>
</tr>
<tr>
  <th>age</th>         <td>   -0.0629</td> <td>    0.013</td> <td>   -4.918</td> <td> 0.000</td> <td>   -0.088</td> <td>   -0.038</td>
</tr>
<tr>
  <th>wif_college</th> <td>    0.8073</td> <td>    0.230</td> <td>    3.510</td> <td> 0.000</td> <td>    0.357</td> <td>    1.258</td>
</tr>
<tr>
  <th>hus_college</th> <td>    0.1117</td> <td>    0.206</td> <td>    0.542</td> <td> 0.588</td> <td>   -0.292</td> <td>    0.516</td>
</tr>
<tr>
  <th>log_wage</th>    <td>    0.6047</td> <td>    0.151</td> <td>    4.009</td> <td> 0.000</td> <td>    0.309</td> <td>    0.900</td>
</tr>
<tr>
  <th>fam_income</th>  <td>   -0.0344</td> <td>    0.008</td> <td>   -4.196</td> <td> 0.000</td> <td>   -0.051</td> <td>   -0.018</td>
</tr>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">logit</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">y_pred</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">753</span><span class="p">,</span><span class="mi">753</span><span class="p">),</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.601106
         Iterations 6
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/numpy-statistics_92_1.png"><img alt="../_images/numpy-statistics_92_1.png" class="align-center" src="../_images/numpy-statistics_92_1.png" style="width: 593.0px; height: 302.5px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">probit</span> <span class="o">=</span> <span class="n">Probit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">probit</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.601189
         Iterations 5
</pre></div>
</div>
<div class="output text_html"><table class="simpletable">
<caption>Probit Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>      <td>labor_join</td>    <th>  No. Observations:  </th>  <td>   753</td>  
</tr>
<tr>
  <th>Model:</th>                <td>Probit</td>      <th>  Df Residuals:      </th>  <td>   745</td>  
</tr>
<tr>
  <th>Method:</th>                 <td>MLE</td>       <th>  Df Model:          </th>  <td>     7</td>  
</tr>
<tr>
  <th>Date:</th>            <td>Sun, 25 Jul 2021</td> <th>  Pseudo R-squ.:     </th>  <td>0.1208</td>  
</tr>
<tr>
  <th>Time:</th>                <td>19:49:46</td>     <th>  Log-Likelihood:    </th> <td> -452.69</td> 
</tr>
<tr>
  <th>converged:</th>             <td>True</td>       <th>  LL-Null:           </th> <td> -514.87</td> 
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>  LLR p-value:       </th> <td>9.471e-24</td>
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>const</th>       <td>    1.9184</td> <td>    0.381</td> <td>    5.040</td> <td> 0.000</td> <td>    1.172</td> <td>    2.664</td>
</tr>
<tr>
  <th>chil5</th>       <td>   -0.8747</td> <td>    0.114</td> <td>   -7.703</td> <td> 0.000</td> <td>   -1.097</td> <td>   -0.652</td>
</tr>
<tr>
  <th>chil618</th>     <td>   -0.0386</td> <td>    0.040</td> <td>   -0.953</td> <td> 0.340</td> <td>   -0.118</td> <td>    0.041</td>
</tr>
<tr>
  <th>age</th>         <td>   -0.0378</td> <td>    0.008</td> <td>   -4.971</td> <td> 0.000</td> <td>   -0.053</td> <td>   -0.023</td>
</tr>
<tr>
  <th>wif_college</th> <td>    0.4883</td> <td>    0.135</td> <td>    3.604</td> <td> 0.000</td> <td>    0.223</td> <td>    0.754</td>
</tr>
<tr>
  <th>hus_college</th> <td>    0.0572</td> <td>    0.124</td> <td>    0.461</td> <td> 0.645</td> <td>   -0.186</td> <td>    0.300</td>
</tr>
<tr>
  <th>log_wage</th>    <td>    0.3656</td> <td>    0.088</td> <td>    4.165</td> <td> 0.000</td> <td>    0.194</td> <td>    0.538</td>
</tr>
<tr>
  <th>fam_income</th>  <td>   -0.0205</td> <td>    0.005</td> <td>   -4.297</td> <td> 0.000</td> <td>   -0.030</td> <td>   -0.011</td>
</tr>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">probit</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.601189
         Iterations 5
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      0.520697
1      0.665092
2      0.464379
3      0.659372
4      0.665338
         ...   
748    0.755185
749    0.183754
750    0.660005
751    0.338742
752    0.522859
Length: 753, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="panel-data-regression">
<h3>3.2. Panel data regression<a class="headerlink" href="#panel-data-regression" title="Permalink to this headline">#</a></h3>
<p>Panel data is the combination of time-series and cross-section data. Panel data is required when we want to analyse the unobserved variables which effects to dependent variable. There are 2 models to analyse panel data: <em>fixed effects regression</em> and <em>random effects regression</em></p>
<section id="fixed-effects-model">
<h4>Fixed effects model<a class="headerlink" href="#fixed-effects-model" title="Permalink to this headline">#</a></h4>
<p>Fix effects regression:</p>
<div class="math notranslate nohighlight">
\[Y_{it} = \beta_0 + \beta_1 X_{it} + \beta_2 Z_i +  u_{it}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Y_{it}\)</span>: dependent variable</p></li>
<li><p><span class="math notranslate nohighlight">\(X_{it}\)</span>: independent variable</p></li>
<li><p><span class="math notranslate nohighlight">\(Z_i\)</span>: unobserved variable - which different between objects but unchange across the time.</p></li>
</ul>
<p>Setting <span class="math notranslate nohighlight">\(\alpha_i = \beta_0 + \beta_2 Z_i\)</span> results:</p>
<div class="math notranslate nohighlight">
\[Y_{it} = \beta_1 X_{1,it} + \cdots + \beta_k X_{k,it} + \alpha_i + u_{it}\]</div>
</section>
<section id="random-effects-model">
<h4>Random effects model<a class="headerlink" href="#random-effects-model" title="Permalink to this headline">#</a></h4>
<p>Random effects model is a special case of fixed effects model. The function is the same as fixed effects model but the unobserved variable is difference.</p>
<div class="math notranslate nohighlight">
\[Y_{it} = \beta_1 X_{1,it} + \cdots + \beta_k X_{k,it} + \alpha_i + u_{it}\]</div>
<p>With <span class="math notranslate nohighlight">\(\alpha_i\)</span> is representative for the factors which unobserved and change between objects but unchange across the time.</p>
</section>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><em><a class="reference external" href="http://online.stat.psu.edu">online.stat.psu.edu</a> - <a class="reference external" href="https://online.stat.psu.edu/stat415/section/6">Introduction to Mathematical Statistics</a></em></p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "hungpq7/tabular-book",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapter-02"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="numpy-probability.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Numpy: Probability</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="scipy-hypothesis-testing.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Scipy: Hypothesis Testing</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Quang Hung &#9829; Thuy Linh<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>